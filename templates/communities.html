{% extends "base.html" %}

{% block title %}–°–æ–æ–±—â–µ—Å—Ç–≤–∞ - –õ–∏–Ω–∫–∞{% endblock %}

{% block content %}
<div class="communities-layout">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –∫–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è -->
    <div class="communities-header">
        <div class="header-content">
            <h1><i class="fas fa-users"></i> –°–æ–æ–±—â–µ—Å—Ç–≤–∞</h1>
            <p>–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞–º –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ —Å–≤–æ–∏</p>
        </div>
        <button onclick="showCreateCommunityPopup()" class="btn btn-primary create-community-btn">
            <i class="fas fa-plus"></i> –°–æ–∑–¥–∞—Ç—å —Å–æ–æ–±—â–µ—Å—Ç–≤–æ
        </button>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ—Å—Ç–≤ -->
    <div class="communities-grid">
        {% if communities %}
            {% for community in communities %}
            <div class="community-card">
                <!-- –û–±–ª–æ–∂–∫–∞ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ -->
                <div class="community-cover">
                    {% if community.cover_image %}
                        <img src="{{ url_for('static', filename=community.cover_image) }}" alt="–û–±–ª–æ–∂–∫–∞ {{ community.name }}">
                    {% else %}
                        <div class="default-cover">
                            <i class="fas fa-users"></i>
                        </div>
                    {% endif %}
                    
                    <!-- –°—Ç–∞—Ç—É—Å –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏ -->
                    {% if community.is_private %}
                        <div class="privacy-badge private">
                            <i class="fas fa-lock"></i>
                        </div>
                    {% else %}
                        <div class="privacy-badge public">
                            <i class="fas fa-globe"></i>
                        </div>
                    {% endif %}
                </div>
                
                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ–æ–±—â–µ—Å—Ç–≤–µ -->
                <div class="community-info">
                    <div class="community-avatar">
                        {% if community.avatar %}
                            <img src="{{ url_for('static', filename=community.avatar) }}" alt="–ê–≤–∞—Ç–∞—Ä {{ community.name }}">
                        {% else %}
                            <div class="default-avatar">
                                {{ community.name[0].upper() }}
                            </div>
                        {% endif %}
                    </div>
                    
                    <div class="community-details">
                        <h3 class="community-name">
                            <a href="{{ url_for('community', community_id=community.id) }}">
                                {{ community.name }}
                            </a>
                        </h3>
                        
                        {% if community.description %}
                            <p class="community-description">{{ community.description[:100] }}{% if community.description|length > 100 %}...{% endif %}</p>
                        {% endif %}
                        
                        {% if community.category %}
                            <span class="community-category">{{ community.category }}</span>
                        {% endif %}
                    </div>
                </div>
                
                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ -->
                <div class="community-stats">
                    <div class="stat">
                        <i class="fas fa-users"></i>
                        <span>{{ community.member_count() }} —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</span>
                    </div>
                    <div class="stat">
                        <i class="fas fa-newspaper"></i>
                        <span>{{ community.post_count() }} –ø–æ—Å—Ç–æ–≤</span>
                    </div>
                </div>
                
                <!-- –î–µ–π—Å—Ç–≤–∏—è -->
                <div class="community-actions">
                    {% if community.creator_id == user_id %}
                        <span class="creator-badge">
                            <i class="fas fa-crown"></i> –°–æ–∑–¥–∞—Ç–µ–ª—å
                        </span>
                    {% else %}
                        {% set is_member = false %}
                        {% for member in community.members %}
                            {% if member.user_id == user_id %}
                                {% set is_member = true %}
                            {% endif %}
                        {% endfor %}
                        
                        {% if is_member %}
                            <a href="{{ url_for('community', community_id=community.id) }}" class="btn btn-secondary">
                                <i class="fas fa-eye"></i> –ü—Ä–æ—Å–º–æ—Ç—Ä
                            </a>
                        {% else %}
                            <a href="{{ url_for('join_community', community_id=community.id) }}" class="btn btn-success">
                                <i class="fas fa-user-plus"></i> –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è
                            </a>
                        {% endif %}
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="empty-state">
                <div class="empty-icon">
                    <i class="fas fa-users"></i>
                </div>
                <h3>–ü–æ–∫–∞ –Ω–µ—Ç —Å–æ–æ–±—â–µ—Å—Ç–≤</h3>
                <p>–ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º, –∫—Ç–æ —Å–æ–∑–¥–∞—Å—Ç —Å–æ–æ–±—â–µ—Å—Ç–≤–æ –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–µ–π –≤–∞—Å —Ç–µ–º–µ!</p>
                <button onclick="showCreateCommunityPopup()" class="btn btn-primary">
                    <i class="fas fa-plus"></i> –°–æ–∑–¥–∞—Ç—å —Å–æ–æ–±—â–µ—Å—Ç–≤–æ
                </button>
            </div>
        {% endif %}
    </div>
</div>

<!-- –ü–æ–ø-–∞–ø —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ -->
<div id="create-community-popup" class="popup-overlay" style="display: none;">
    <div class="popup-content">
        <!-- –≠—Ç–∞–ø 1: –í—ã–±–æ—Ä —Ü–µ–ª–∏ -->
        <div id="step-1" class="popup-step">
            <div class="popup-header">
                <h2>–ö–∞–∫–∞—è —É –≤–∞—Å —Ü–µ–ª—å?</h2>
                <button class="close-btn" onclick="closeCreateCommunityPopup()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="goal-selection">
                <div class="goal-option" onclick="selectGoal('content')">
                    <div class="goal-icon">
                        <i class="fas fa-comments"></i>
                    </div>
                    <div class="goal-content">
                        <h3>–î–µ–ª–∏—Ç—å—Å—è –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º –∏ –æ–±—â–∞—Ç—å—Å—è</h3>
                        <p>–°–æ–∑–¥–∞–π—Ç–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ –¥–ª—è –æ–±—â–µ–Ω–∏—è, –æ–±–º–µ–Ω–∞ –º–Ω–µ–Ω–∏—è–º–∏ –∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º</p>
                    </div>
                    <div class="goal-arrow">
                        <i class="fas fa-chevron-right"></i>
                    </div>
                </div>
                
                <div class="goal-option" onclick="selectGoal('business')">
                    <div class="goal-icon">
                        <i class="fas fa-briefcase"></i>
                    </div>
                    <div class="goal-content">
                        <h3>–†–∞–∑–≤–∏–≤–∞—Ç—å –±–∏–∑–Ω–µ—Å</h3>
                        <p>–°–æ–∑–¥–∞–π—Ç–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ –¥–ª—è –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è –≤–∞—à–µ–≥–æ –±–∏–∑–Ω–µ—Å–∞ –∏ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤</p>
                    </div>
                    <div class="goal-arrow">
                        <i class="fas fa-chevron-right"></i>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –≠—Ç–∞–ø 2A: –î–µ–ª–∏—Ç—å—Å—è –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º -->
        <div id="step-2a" class="popup-step" style="display: none;">
            <div class="popup-header">
                <button class="back-btn" onclick="goBackToStep1()">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2>–°–æ–∑–¥–∞–π—Ç–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ –¥–ª—è –≤–∞—à–µ–≥–æ –±–ª–æ–≥–∞</h2>
                <button class="close-btn" onclick="closeCreateCommunityPopup()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="content-creation-form">
                <div class="form-group">
                    <label for="content-avatar">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∞–≤–∞—Ç–∞—Ä</label>
                    <div class="file-upload-area" onclick="document.getElementById('content-avatar').click()">
                        <i class="fas fa-camera"></i>
                        <p id="avatar-text">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ –∞–≤–∞—Ç–∞—Ä–∞</p>
                    </div>
                    <input type="file" id="content-avatar" name="avatar" accept="image/*" style="display: none;">
                    <div id="avatar-preview" class="avatar-preview" style="display: none;">
                        <span id="avatar-filename"></span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="content-name">–ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ *</label>
                    <input type="text" id="content-name" name="name" required 
                           placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞"
                           maxlength="100">
                    
                </div>
                
                <div class="form-group">
                    <label for="content-privacy">–ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</label>
                    <div class="privacy-options">
                        <label class="privacy-option">
                            <input type="radio" name="content-privacy" value="public" checked>
                            <span class="radio-custom"></span>
                            <div class="privacy-info">
                                <strong>–ü—É–±–ª–∏—á–Ω–æ–µ</strong>
                                <small>–í–∏–¥–Ω–æ –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º</small>
                            </div>
                        </label>
                        <label class="privacy-option">
                            <input type="radio" name="content-privacy" value="private">
                            <span class="radio-custom"></span>
                            <div class="privacy-info">
                                <strong>–ü—Ä–∏–≤–∞—Ç–Ω–æ–µ</strong>
                                <small>–í–∏–¥–Ω–æ —Ç–æ–ª—å–∫–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º</small>
                            </div>
                        </label>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" onclick="goBackToStep1()" class="btn btn-secondary">
                        <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
                    </button>
                    <button type="button" onclick="goToContentStep3()" class="btn btn-primary">
                        –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- –≠—Ç–∞–ø 2B: –†–∞–∑–≤–∏–≤–∞—Ç—å –±–∏–∑–Ω–µ—Å -->
        <div id="step-2b" class="popup-step" style="display: none;">
            <div class="popup-header">
                <button class="back-btn" onclick="goBackToStep1()">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2>–°–æ–∑–¥–∞–π—Ç–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ –¥–ª—è –≤–∞—à–µ–≥–æ –±–∏–∑–Ω–µ—Å–∞</h2>
                <button class="close-btn" onclick="closeCreateCommunityPopup()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="business-creation-layout">
                <div class="business-benefits">
                    <div class="benefit-item">
                        <div class="benefit-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="benefit-text">
                            <strong>–ü–æ–ª—É—á–∏—Ç–µ –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤</strong>
                            <p>—Å –ø–æ–º–æ—â—å—é –æ–≥—Ä–æ–º–Ω–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏</p>
                        </div>
                    </div>
                    
                    <div class="benefit-item">
                        <div class="benefit-icon">
                            <i class="fas fa-comments"></i>
                        </div>
                        <div class="benefit-text">
                            <strong>–û–±—â–∞–π—Ç–µ—Å—å —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏</strong>
                            <p>—á–µ—Ä–µ–∑ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä</p>
                        </div>
                    </div>
                    
                    <div class="benefit-item">
                        <div class="benefit-icon">
                            <i class="fas fa-store"></i>
                        </div>
                        <div class="benefit-text">
                            <strong>–ü—É–±–ª–∏–∫—É–π—Ç–µ —Ç–æ–≤–∞—Ä—ã –∏ —É—Å–ª—É–≥–∏</strong>
                            <p>–≤ —Å–æ–æ–±—â–µ—Å—Ç–≤–µ –∏ –ø—Ä–æ–¥–∞–≤–∞–π—Ç–µ –∏—Ö</p>
                        </div>
                    </div>
                    
                    <div class="benefit-item">
                        <div class="benefit-icon">
                            <i class="fas fa-globe"></i>
                        </div>
                        <div class="benefit-text">
                            <strong>–ü–æ–ª—É—á–∏—Ç–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ</strong>
                            <p>–≤–∞—à–µ–π –∫–æ–º–ø–∞–Ω–∏–∏</p>
                        </div>
                    </div>
                </div>
                
                <div class="business-form">
                    <div class="form-group">
                        <label for="business-name">–ù–∞–∑–≤–∞–Ω–∏–µ *</label>
                        <input type="text" id="business-name" name="name" required 
                               placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞"
                               maxlength="100">
                        <div class="input-tips" id="business-name-tips" style="display: none;">
                            <div class="example-comparison">
                                <div class="example-correct">
                                    <span class="example-label">‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:</span>
                                    <span class="example-text">"–°—Ç–∞—Ä—Ç–∞–ø –•–∞–±"</span>
                                </div>
                                <div class="example-incorrect">
                                    <span class="example-label">‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:</span>
                                    <span class="example-text">"–°–æ–æ–±—â–µ—Å—Ç–≤–æ –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è —Å—Ç–∞—Ä—Ç–∞–ø–æ–≤ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –∏–Ω–Ω–æ–≤–∞—Ü–∏–π –≤ —Å—Ñ–µ—Ä–µ IT"</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="business-theme">–¢–µ–º–∞—Ç–∏–∫–∞ *</label>
                        <select id="business-theme" name="theme" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º–∞—Ç–∏–∫—É</option>
                            <option value="–ë–∏–∑–Ω–µ—Å">üíº –ë–∏–∑–Ω–µ—Å</option>
                            <option value="–¢–æ—Ä–≥–æ–≤–ª—è">üõçÔ∏è –¢–æ—Ä–≥–æ–≤–ª—è</option>
                            <option value="–£—Å–ª—É–≥–∏">üîß –£—Å–ª—É–≥–∏</option>
                            <option value="–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ">üìö –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</option>
                            <option value="–ó–¥–æ—Ä–æ–≤—å–µ">üè• –ó–¥–æ—Ä–æ–≤—å–µ</option>
                            <option value="–ö—Ä–∞—Å–æ—Ç–∞">üíÑ –ö—Ä–∞—Å–æ—Ç–∞</option>
                            <option value="–°–ø–æ—Ä—Ç">‚öΩ –°–ø–æ—Ä—Ç</option>
                            <option value="–î—Ä—É–≥–æ–µ">üîß –î—Ä—É–≥–æ–µ</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="business-description">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea id="business-description" name="description" rows="4" 
                                  placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –≤–∞—à–µ–º –±–∏–∑–Ω–µ—Å–µ, —Ç–æ–≤–∞—Ä–∞—Ö –∏–ª–∏ —É—Å–ª—É–≥–∞—Ö"></textarea>
                        <div class="input-tips" id="business-desc-tips" style="display: none;">
                            <div class="example-comparison">
                                <div class="example-correct">
                                    <span class="example-label">‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:</span>
                                    <span class="example-text">"–ú—ã —Å–æ–∑–¥–∞–µ–º –±—É–¥—É—â–µ–µ –±–∏–∑–Ω–µ—Å–∞ —á–µ—Ä–µ–∑ –∏–Ω–Ω–æ–≤–∞—Ü–∏–∏ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏"</span>
                                </div>
                                <div class="example-incorrect">
                                    <span class="example-label">‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:</span>
                                    <span class="example-text">"–ú—ã –∫–æ–º–ø–∞–Ω–∏—è –∫–æ—Ç–æ—Ä–∞—è –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –¥–ª—è –±–∏–∑–Ω–µ—Å–∞ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã–µ —É—Å–ª—É–≥–∏ –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤"</span>
                                </div>
                            </div>
                        </div>
                        <div class="char-counter">
                            <span id="business-char-count">0</span> / 4000
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" onclick="goBackToStep1()" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
                        </button>
                        <button type="button" onclick="createBusinessCommunity()" class="btn btn-primary">
                            –°–æ–∑–¥–∞—Ç—å —Å–æ–æ–±—â–µ—Å—Ç–≤–æ
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –≠—Ç–∞–ø 3: –í—ã–±–æ—Ä —Ç–µ–º–∞—Ç–∏–∫–∏ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ -->
        <div id="step-3" class="popup-step" style="display: none;">
            <div class="popup-header">
                <button class="back-btn" onclick="goBackToContentStep2()">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º–∞—Ç–∏–∫—É</h2>
                <button class="close-btn" onclick="closeCreateCommunityPopup()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="theme-selection">
                <div class="theme-grid">
                    <div class="theme-option" data-theme="–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏">
                        <div class="theme-icon">üíª</div>
                        <span>–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</span>
                    </div>
                    <div class="theme-option" data-theme="–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è">
                        <div class="theme-icon">üéÆ</div>
                        <span>–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</span>
                    </div>
                    <div class="theme-option" data-theme="–°–ø–æ—Ä—Ç">
                        <div class="theme-icon">‚öΩ</div>
                        <span>–°–ø–æ—Ä—Ç</span>
                    </div>
                    <div class="theme-option" data-theme="–ú—É–∑—ã–∫–∞">
                        <div class="theme-icon">üéµ</div>
                        <span>–ú—É–∑—ã–∫–∞</span>
                    </div>
                    <div class="theme-option" data-theme="–ö–∏–Ω–æ">
                        <div class="theme-icon">üé¨</div>
                        <span>–ö–∏–Ω–æ</span>
                    </div>
                    <div class="theme-option" data-theme="–ö—É–ª–∏–Ω–∞—Ä–∏—è">
                        <div class="theme-icon">üç≥</div>
                        <span>–ö—É–ª–∏–Ω–∞—Ä–∏—è</span>
                    </div>
                    <div class="theme-option" data-theme="–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è">
                        <div class="theme-icon">‚úàÔ∏è</div>
                        <span>–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è</span>
                    </div>
                    <div class="theme-option" data-theme="–ú–æ–¥–∞">
                        <div class="theme-icon">üëó</div>
                        <span>–ú–æ–¥–∞</span>
                    </div>
                    <div class="theme-option" data-theme="–ê–≤—Ç–æ">
                        <div class="theme-icon">üöó</div>
                        <span>–ê–≤—Ç–æ</span>
                    </div>
                    <div class="theme-option" data-theme="–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ">
                        <div class="theme-icon">üìö</div>
                        <span>–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</span>
                    </div>
                    <div class="theme-option" data-theme="–ó–¥–æ—Ä–æ–≤—å–µ">
                        <div class="theme-icon">üè•</div>
                        <span>–ó–¥–æ—Ä–æ–≤—å–µ</span>
                    </div>
                    <div class="theme-option" data-theme="–•–æ–±–±–∏">
                        <div class="theme-icon">üé®</div>
                        <span>–•–æ–±–±–∏</span>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" onclick="goBackToContentStep2()" class="btn btn-secondary">
                        <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
                    </button>
                    <button type="button" onclick="createContentCommunity()" class="btn btn-primary">
                        –°–æ–∑–¥–∞—Ç—å —Å–æ–æ–±—â–µ—Å—Ç–≤–æ
                    </button>
                </div>
            </div>
        </div>
        

    </div>
</div>

<script>
    let currentStep = 1;
    let selectedGoal = null;
    let selectedTheme = null;
    let communityData = {};
    
    // –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ø-–∞–ø —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–æ–±—â–µ—Å—Ç–≤–∞
    function showCreateCommunityPopup() {
        document.getElementById('create-community-popup').style.display = 'flex';
        document.body.style.overflow = 'hidden';
        showStep(1);
    }
    
    // –ó–∞–∫—Ä—ã—Ç—å –ø–æ–ø-–∞–ø —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–æ–±—â–µ—Å—Ç–≤–∞
    function closeCreateCommunityPopup() {
        document.getElementById('create-community-popup').style.display = 'none';
        document.body.style.overflow = 'auto';
        resetPopupForm();
        currentStep = 1;
        selectedGoal = null;
        selectedTheme = null;
        communityData = {};
    }
    
    // –ü–æ–∫–∞–∑–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —ç—Ç–∞–ø
    function showStep(stepNumber) {
        // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —ç—Ç–∞–ø—ã
        document.querySelectorAll('.popup-step').forEach(step => {
            step.style.display = 'none';
        });
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π —ç—Ç–∞–ø
        document.getElementById(`step-${stepNumber}`).style.display = 'block';
        currentStep = stepNumber;
    }
    
    // –í—ã–±–æ—Ä —Ü–µ–ª–∏
    function selectGoal(goal) {
        selectedGoal = goal;
        if (goal === 'content') {
            showStep('2a');
        } else if (goal === 'business') {
            showStep('2b');
        }
    }
    
    // –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø–µ—Ä–≤–æ–º—É —ç—Ç–∞–ø—É
    function goBackToStep1() {
        showStep(1);
    }
    
    // –í–µ—Ä–Ω—É—Ç—å—Å—è –∫–æ –≤—Ç–æ—Ä–æ–º—É —ç—Ç–∞–ø—É –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
    function goBackToContentStep2() {
        showStep('2a');
    }
    
    // –ü–µ—Ä–µ–π—Ç–∏ –∫ —Ç—Ä–µ—Ç—å–µ–º—É —ç—Ç–∞–ø—É –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
    function goToContentStep3() {
        // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –≤—Ç–æ—Ä–æ–≥–æ —ç—Ç–∞–ø–∞
        const name = document.getElementById('content-name').value;
        const privacy = document.querySelector('input[name="content-privacy"]:checked').value;
        const avatar = document.getElementById('content-avatar').files[0];
        
        if (!name.trim()) {
            showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞', 'error');
            return;
        }
        
        communityData.name = name;
        communityData.is_private = privacy === 'private';
        communityData.avatar = avatar;
        
        showStep(3);
    }
    
    // –°–æ–∑–¥–∞—Ç—å —Å–æ–æ–±—â–µ—Å—Ç–≤–æ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
    function createContentCommunity() {
        if (!selectedTheme) {
            showNotification('–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º–∞—Ç–∏–∫—É', 'error');
            return;
        }
        
        communityData.category = selectedTheme;
        communityData.description = '–°–æ–æ–±—â–µ—Å—Ç–≤–æ –¥–ª—è –æ–±—â–µ–Ω–∏—è –∏ –æ–±–º–µ–Ω–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º';
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        createCommunity();
    }
    
    // –°–æ–∑–¥–∞—Ç—å —Å–æ–æ–±—â–µ—Å—Ç–≤–æ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞
    function createBusinessCommunity() {
        const name = document.getElementById('business-name').value;
        const theme = document.getElementById('business-theme').value;
        const description = document.getElementById('business-description').value;
        
        if (!name.trim() || !theme) {
            showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error');
            return;
        }
        
        communityData.name = name;
        communityData.category = theme;
        communityData.description = description;
        communityData.is_private = false;
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        createCommunity();
    }
    
    // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä
    function createCommunity() {
        const formData = new FormData();
        
        // –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
        Object.keys(communityData).forEach(key => {
            if (communityData[key] !== null && communityData[key] !== undefined) {
                if (key === 'avatar' && communityData[key] instanceof File) {
                    formData.append(key, communityData[key]);
                } else {
                    formData.append(key, communityData[key]);
                }
            }
        });
        
        fetch('{{ url_for("create_community") }}', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // –°—Ä–∞–∑—É –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–æ–∑–¥–∞–Ω–Ω–æ–º—É —Å–æ–æ–±—â–µ—Å—Ç–≤—É
                closeCreateCommunityPopup();
                window.location.href = `/community/${data.community_id}`;
            } else {
                showNotification(data.error, 'error');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            showNotification('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞', 'error');
        });
    }
    

    
         // –°–±—Ä–æ—Å–∏—Ç—å —Ñ–æ—Ä–º—É –ø–æ–ø-–∞–ø–∞
     function resetPopupForm() {
         // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ –ø–æ–ª—è
         document.getElementById('content-name').value = '';
         document.getElementById('business-name').value = '';
         document.getElementById('business-theme').value = '';
         document.getElementById('business-description').value = '';
         document.getElementById('content-avatar').value = '';
         
         // –°–∫—Ä—ã–≤–∞–µ–º —Å–æ–≤–µ—Ç—ã
         document.getElementById('business-name-tips').style.display = 'none';
         document.getElementById('business-desc-tips').style.display = 'none';
         
         // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ —Å–∏–º–≤–æ–ª–æ–≤
         document.getElementById('business-char-count').textContent = '0';
         
         // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Ç–µ–º–∞—Ç–∏–∫—É
         selectedTheme = null;
         document.querySelectorAll('.theme-option').forEach(option => {
             option.classList.remove('selected');
         });
     }
    
    // –í—ã–±–æ—Ä —Ç–µ–º–∞—Ç–∏–∫–∏
    document.addEventListener('DOMContentLoaded', function() {
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ —Ç–µ–º–∞—Ç–∏–∫–∏
        document.querySelectorAll('.theme-option').forEach(option => {
            option.addEventListener('click', function() {
                // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö –æ–ø—Ü–∏–π
                document.querySelectorAll('.theme-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                
                // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –æ–ø—Ü–∏—é
                this.classList.add('selected');
                selectedTheme = this.dataset.theme;
            });
        });
        
                 // –°—á–µ—Ç—á–∏–∫ —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –±–∏–∑–Ω–µ—Å–∞
         document.getElementById('business-description').addEventListener('input', function() {
             const count = this.value.length;
             document.getElementById('business-char-count').textContent = count;
             
             // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º —Å–æ–≤–µ—Ç—ã –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è
             const tips = document.getElementById('business-desc-tips');
             if (count > 0) {
                 tips.style.display = 'block';
             } else {
                 tips.style.display = 'none';
             }
         });
         
                 // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º —Å–æ–≤–µ—Ç—ã –¥–ª—è –Ω–∞–∑–≤–∞–Ω–∏—è
        document.getElementById('business-name').addEventListener('input', function() {
            const tips = document.getElementById('business-name-tips');
            if (this.value.length > 0) {
                tips.style.display = 'block';
            } else {
                tips.style.display = 'none';
            }
        });
        
        // –°–∫—Ä—ã–≤–∞–µ–º —Å–æ–≤–µ—Ç—ã –¥–ª—è –Ω–∞–∑–≤–∞–Ω–∏—è –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Ñ–æ–∫—É—Å–∞
        document.getElementById('business-name').addEventListener('blur', function() {
            const tips = document.getElementById('business-name-tips');
            tips.style.display = 'none';
        });
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–≤–µ—Ç—ã –¥–ª—è –Ω–∞–∑–≤–∞–Ω–∏—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ñ–æ–∫—É—Å–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å —Ç–µ–∫—Å—Ç)
        document.getElementById('business-name').addEventListener('focus', function() {
            const tips = document.getElementById('business-name-tips');
            if (this.value.length > 0) {
                tips.style.display = 'block';
            }
        });
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º —Å–æ–≤–µ—Ç—ã –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è
        document.getElementById('business-description').addEventListener('input', function() {
            const tips = document.getElementById('business-desc-tips');
            const charCount = document.getElementById('business-char-count');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫–∏
            if (this.value.length > 0) {
                tips.style.display = 'block';
            } else {
                tips.style.display = 'none';
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ —Å–∏–º–≤–æ–ª–æ–≤
            charCount.textContent = this.value.length;
        });
        
        // –°–∫—Ä—ã–≤–∞–µ–º —Å–æ–≤–µ—Ç—ã –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Ñ–æ–∫—É—Å–∞
        document.getElementById('business-description').addEventListener('blur', function() {
            const tips = document.getElementById('business-desc-tips');
            tips.style.display = 'none';
        });
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–≤–µ—Ç—ã –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ñ–æ–∫—É—Å–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å —Ç–µ–∫—Å—Ç)
        document.getElementById('business-description').addEventListener('focus', function() {
            const tips = document.getElementById('business-desc-tips');
            if (this.value.length > 0) {
                tips.style.display = 'block';
            }
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤–∞—Ç–∞—Ä–∞ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        document.getElementById('content-avatar').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —Ñ–∞–π–ª–µ
                const avatarText = document.getElementById('avatar-text');
                const avatarPreview = document.getElementById('avatar-preview');
                const avatarFilename = document.getElementById('avatar-filename');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç
                avatarText.textContent = '–§–∞–π–ª –≤—ã–±—Ä–∞–Ω ‚úì';
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
                avatarFilename.textContent = file.name;
                avatarPreview.style.display = 'block';
                
                console.log('–ê–≤–∞—Ç–∞—Ä –∑–∞–≥—Ä—É–∂–µ–Ω:', file.name);
            }
        });
    });
    
    // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    function showNotification(message, type) {
        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        notification.innerHTML = `
            <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'}"></i>
            <span>${message}</span>
        `;
        
        document.body.appendChild(notification);
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        setTimeout(() => {
            notification.classList.add('show');
        }, 100);
        
        // –°–∫—Ä—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
        setTimeout(() => {
            notification.classList.remove('show');
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 300);
        }, 3000);
    }
    
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–ø-–∞–ø–∞ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –µ–≥–æ
    document.getElementById('create-community-popup').addEventListener('click', function(e) {
        if (e.target === this) {
            closeCreateCommunityPopup();
        }
    });
</script>

<style>
    .communities-layout {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem 1rem;
    }
    
    .communities-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 3rem;
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 8px;
        padding: 2rem;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
    }
    
    .header-content h1 {
        color: #1A1A1A;
        margin: 0 0 0.5rem 0;
        font-size: 2.5rem;
        font-weight: 700;
        display: flex;
        align-items: center;
        gap: 1rem;
    }
    
    .header-content p {
        color: rgba(26, 26, 26, 0.8);
        margin: 0;
        font-size: 1.1rem;
    }
    
    .create-community-btn {
        background: #007AFF;
        border: none;
        color: #ffffff;
        padding: 0.9rem 1.6rem;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.75rem;
        transition: all 0.2s ease;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }
    
    .create-community-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        background: #005FCC;
        color: #ffffff;
    }
    
    .communities-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        gap: 2rem;
    }
    
    .community-card {
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 8px;
        overflow: hidden;
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
    }
    
    .community-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 24px rgba(0, 0, 0, 0.08);
    }
    
    .community-cover {
        position: relative;
        height: 150px;
        overflow: hidden;
    }
    
    .community-cover img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    
    .default-cover {
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #007AFF, #66A3FF);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 3rem;
    }
    
    .privacy-badge {
        position: absolute;
        top: 1rem;
        right: 1rem;
        padding: 0.5rem;
        border-radius: 50%;
        color: white;
        font-size: 0.9rem;
    }
    
    .privacy-badge.private {
        background: rgba(231, 76, 60, 0.9);
    }
    
    .privacy-badge.public {
        background: rgba(46, 204, 113, 0.9);
    }
    
    .community-info {
        padding: 1.5rem;
        display: flex;
        gap: 1rem;
        align-items: flex-start;
    }
    
    .community-avatar {
        flex-shrink: 0;
    }
    
    .community-avatar img {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        object-fit: cover;
    }
    
    .default-avatar {
        width: 60px;
        height: 60px;
        background: linear-gradient(45deg, #007AFF, #66A3FF);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        color: white;
        font-size: 1.5rem;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
    }
    
    .community-details {
        flex: 1;
        min-width: 0;
    }
    
    .community-name {
        margin: 0 0 0.5rem 0;
        font-size: 1.3rem;
        font-weight: 600;
    }
    
    .community-name a {
        color: #1A1A1A;
        text-decoration: none;
    }
    
    .community-name a:hover {
        color: #007AFF;
    }
    
    .community-description {
        color: rgba(26, 26, 26, 0.8);
        margin: 0 0 0.75rem 0;
        line-height: 1.5;
        font-size: 0.95rem;
    }
    
    .community-category {
        display: inline-block;
        background: rgba(0, 122, 255, 0.1);
        color: #007AFF;
        padding: 0.3rem 0.8rem;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 500;
    }
    
    .community-stats {
        padding: 0 1.5rem 1rem;
        display: flex;
        gap: 2rem;
        border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    }
    
    .stat {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: rgba(26, 26, 26, 0.7);
        font-size: 0.9rem;
    }
    
    .stat i {
        color: #007AFF;
        font-size: 0.8rem;
    }
    
    .community-actions {
        padding: 1.5rem;
        display: flex;
        justify-content: center;
    }
    
    .creator-badge {
        background: rgba(0, 122, 255, 0.1);
        color: #007AFF!important;
        padding: 0.75rem 1.2rem;
        border-radius: 8px;
        font-size: 0.9rem;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        border: 1px solid rgba(0, 122, 255, 0.2);
    }
    
    .btn {
        padding: 0.75rem 1.2rem;
        border: none;
        border-radius: 8px;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        font-weight: 600;
        font-size: 0.9rem;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .btn-secondary {
        background: #ffffff;
        color: #1A1A1A;
        border: 1px solid rgba(0, 0, 0, 0.12);
    }
    
    .btn-secondary:hover {
        background: rgba(0, 0, 0, 0.04);
        color: #1A1A1A;
        transform: translateY(-2px);
    }
    
    .btn-success {
        background: linear-gradient(45deg, #27ae60, #229954);
        color: white;
    }
    
    .btn-success:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(39, 174, 96, 0.3);
    }
    
    .empty-state {
        grid-column: 1 / -1;
        text-align: center;
        padding: 4rem 2rem;
        background: #ffffff;
        border-radius: 8px;
        border: 1px solid rgba(0, 0, 0, 0.08);
    }
    
    .empty-icon {
        font-size: 4rem;
        color: rgba(26, 26, 26, 0.25);
        margin-bottom: 1.5rem;
    }
    
    .empty-state h3 {
        color: rgba(26, 26, 26, 0.85);
        margin-bottom: 1rem;
        font-size: 1.8rem;
    }
    
    .empty-state p {
        color: rgba(26, 26, 26, 0.6);
        margin-bottom: 2rem;
        font-size: 1.1rem;
    }
    
    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
    @media (max-width: 768px) {
        .communities-header {
            flex-direction: column;
            gap: 1.5rem;
            text-align: center;
        }
        
        .communities-grid {
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }
        
        .community-stats {
            flex-direction: column;
            gap: 1rem;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –ø–æ–ø-–∞–ø–∞ */
        .popup-content {
            width: 98%;
            max-height: 95vh;
            margin: 0.5rem;
        }
        
        .business-creation-layout {
            grid-template-columns: 1fr;
            gap: 1.5rem;
            padding: 1.5rem;
        }
        
        .business-form {
            min-height: auto;
            padding: 1rem;
        }
        
        .input-tips li {
            font-size: 0.8rem;
            padding: 0.4rem;
        }
        
        .example-comparison {
            gap: 0.75rem;
        }
        
        .example-correct,
        .example-incorrect {
            padding: 0.75rem;
        }
        
        .example-text {
            font-size: 0.85rem;
        }
        
        .goal-option {
            flex-direction: column;
            text-align: center;
            gap: 1rem;
        }
        
        .goal-icon {
            width: 80px;
            height: 80px;
            font-size: 2rem;
        }
        
        .theme-grid {
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
        }
        
        .popup-header {
            flex-direction: column;
            gap: 1rem;
            text-align: center;
        }
        
        .popup-header h2 {
            font-size: 1.5rem;
        }
    }
    
    /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–ø-–∞–ø–∞ */
    .popup-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.4);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        backdrop-filter: none;
    }
    
    /* –°—Ç–∏–ª–∏ –¥–ª—è —ç—Ç–∞–ø–æ–≤ */
    .popup-step {
        width: 100%;
    }
    
    /* –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥ */
    .back-btn {
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.12);
        color: #1A1A1A;
        padding: 0.5rem;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.1rem;
    }
    
    .back-btn:hover {
        background: rgba(0, 0, 0, 0.04);
        color: #1A1A1A;
        transform: scale(1.05);
    }
    
    /* –í—ã–±–æ—Ä —Ü–µ–ª–∏ */
    .goal-selection {
        padding: 2rem;
    }
    
    .goal-option {
        display: flex;
        align-items: center;
        gap: 1.5rem;
        padding: 1.5rem;
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 8px;
        margin-bottom: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .goal-option:hover {
        background: rgba(0, 0, 0, 0.02);
        border-color: #007AFF;
        transform: translateY(-2px);
    }
    
    .goal-icon {
        width: 60px;
        height: 60px;
        background: rgba(0, 122, 255, 0.12);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        color: #007AFF;
        flex-shrink: 0;
    }
    
    .goal-content {
        flex: 1;
    }
    
    .goal-content h3 {
        color: #1A1A1A;
        margin: 0 0 0.5rem 0;
        font-size: 1.3rem;
        font-weight: 600;
    }
    
    .goal-content p {
        color: rgba(26, 26, 26, 0.7);
        margin: 0;
        line-height: 1.5;
    }
    
    .goal-arrow {
        color: #007AFF;
        font-size: 1.2rem;
    }
    
    /* –§–æ—Ä–º–∞ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
    .content-creation-form {
        padding: 2rem;
    }
    
    /* –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å */
    .privacy-options {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }
    
    .privacy-option {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1rem;
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .privacy-option:hover {
        background: rgba(0, 0, 0, 0.02);
        border-color: #007AFF;
    }
    
    .privacy-option input[type="radio"] {
        display: none;
    }
    
    .radio-custom {
        width: 20px;
        height: 20px;
        border: 2px solid rgba(0, 0, 0, 0.3);
        border-radius: 50%;
        position: relative;
        transition: all 0.3s ease;
    }
    
    .privacy-option input[type="radio"]:checked + .radio-custom {
        border-color: #007AFF;
    }
    
    .privacy-option input[type="radio"]:checked + .radio-custom::after {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 10px;
        height: 10px;
        background: #007AFF;
        border-radius: 50%;
    }
    
    .privacy-info strong {
        color: #1A1A1A;
        display: block;
        margin-bottom: 0.25rem;
    }
    
    .privacy-info small {
        color: rgba(26, 26, 26, 0.6);
        font-size: 0.9rem;
    }
    
    /* –ë–∏–∑–Ω–µ—Å —Å–æ–∑–¥–∞–Ω–∏–µ */
    .business-creation-layout {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 3rem;
        padding: 3rem;
        min-height: 600px;
    }
    
    .business-benefits {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
    }
    
    .benefit-item {
        display: flex;
        align-items: center;
        gap: 1.5rem;
        padding: 1.5rem;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 16px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        transition: all 0.3s ease;
    }
    
    .benefit-item:hover {
        background: rgba(255, 255, 255, 0.08);
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
    }
    
    .benefit-icon {
        width: 60px;
        height: 60px;
        background: #007AFF;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        color: white;
        flex-shrink: 0;
        box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
    }
    
    .benefit-text strong {
        color: #1A1A1A;
        display: block;
        margin-bottom: 0.5rem;
        font-size: 1.1rem;
        font-weight: 700;
    }
    
    .benefit-text p {
        color: rgba(255, 255, 255, 0.7);
        margin: 0;
        font-size: 1rem;
        line-height: 1.4;
    }
    
    .business-form {
        padding: 1.5rem;
        background: rgba(255, 255, 255, 0.02);
        border-radius: 16px;
        border: 1px solid rgba(255, 255, 255, 0.05);
        min-height: 500px;
    }
    
    /* –ü—Ä–∏–º–µ—Ä—ã –ø–æ –≤–≤–æ–¥—É */
    .input-tips {
        margin-top: 0.75rem;
        padding: 1rem;
        background: rgba(52, 152, 219, 0.15);
        border: 1px solid rgba(52, 152, 219, 0.3);
        border-radius: 12px;
        position: relative;
        z-index: 10;
    }
    
    .input-tips p {
        color: rgba(255, 255, 255, 0.9);
        margin: 0 0 0.75rem 0;
        font-size: 0.9rem;
        line-height: 1.4;
        font-weight: 600;
    }
    
    .input-tips strong {
        color: #3498db;
    }
    
    .input-tips ul {
        margin: 0;
        padding: 0;
        list-style: none;
    }
    
    .input-tips li {
        color: rgba(255, 255, 255, 0.8);
        font-size: 0.85rem;
        line-height: 1.5;
        margin-bottom: 0.5rem;
        padding: 0.5rem;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        border-left: 3px solid #3498db;
        transition: all 0.3s ease;
    }
    
    .input-tips li:hover {
        background: rgba(255, 255, 255, 0.08);
        transform: translateX(5px);
    }
    
    .input-tips li:last-child {
        margin-bottom: 0;
    }
    
    /* –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–æ–≤ */
    .example-comparison {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        margin-top: 0;
    }
    
    .example-correct,
    .example-incorrect {
        padding: 1rem;
        border-radius: 12px;
        border-left: 4px solid;
        transition: all 0.3s ease;
    }
    
    .example-correct {
        background: rgba(46, 204, 113, 0.1);
        border-left-color: #27ae60;
    }
    
    .example-incorrect {
        background: rgba(231, 76, 60, 0.1);
        border-left-color: #e74c3c;
    }
    
    .example-label {
        display: block;
        font-weight: 700;
        font-size: 0.9rem;
        margin-bottom: 0.5rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    
    .example-correct .example-label {
        color: #27ae60;
    }
    
    .example-incorrect .example-label {
        color: #e74c3c;
    }
    
    .example-text {
        display: block;
        color: rgba(255, 255, 255, 0.9);
        font-size: 0.95rem;
        line-height: 1.4;
        font-style: italic;
    }
    
    .example-correct:hover,
    .example-incorrect:hover {
        transform: translateX(5px);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }
    
    /* –°—á–µ—Ç—á–∏–∫ —Å–∏–º–≤–æ–ª–æ–≤ */
    .char-counter {
        text-align: right;
        color: rgba(255, 255, 255, 0.5);
        font-size: 0.8rem;
        margin-top: 0.5rem;
    }
    
    /* –í—ã–±–æ—Ä —Ç–µ–º–∞—Ç–∏–∫–∏ */
    .theme-selection {
        padding: 2rem;
    }
    
    .theme-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 1rem;
        margin-bottom: 2rem;
    }
    
    .theme-option {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.5rem;
        padding: 1rem;
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s ease;
        text-align: center;
    }
    
    .theme-option:hover {
        background: rgba(255, 255, 255, 0.08);
        border-color: #3498db;
        transform: translateY(-2px);
    }
    
    .theme-option.selected {
        background: rgba(52, 152, 219, 0.2);
        border-color: #3498db;
        box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.3);
    }
    
    .theme-icon {
        font-size: 2rem;
    }
    
    .theme-option span {
        color: rgba(255, 255, 255, 0.8);
        font-size: 0.9rem;
        font-weight: 500;
    }
    
    /* –ü–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ */
    .success-message {
        text-align: center;
        padding: 2rem;
    }
    
    .success-icon {
        font-size: 4rem;
        color: #27ae60;
        margin-bottom: 1.5rem;
    }
    
    .success-message h3 {
        color: #ffffff;
        margin: 0 0 1rem 0;
        font-size: 1.8rem;
        font-weight: 600;
    }
    
    .success-message p {
        color: rgba(255, 255, 255, 0.7);
        margin: 0 0 2rem 0;
        font-size: 1.1rem;
        line-height: 1.5;
    }
    
    /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
    .notification {
        position: fixed;
        top: 20px;
        right: 20px;
        background: #2c3e50;
        color: white;
        padding: 1rem 1.5rem;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        display: flex;
        align-items: center;
        gap: 0.75rem;
        z-index: 2000;
        transform: translateX(400px);
        transition: transform 0.3s ease;
        max-width: 350px;
    }
    
    .notification.show {
        transform: translateX(0);
    }
    
    .notification.success {
        border-left: 4px solid #27ae60;
    }
    
    .notification.error {
        border-left: 4px solid #e74c3c;
    }
    
    .notification i {
        font-size: 1.2rem;
    }
    
    .notification.success i {
        color: #27ae60;
    }
    
    .notification.error i {
        color: #e74c3c;
    }
    
    .popup-content {
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.12);
        border-radius: 8px;
        padding: 0;
        max-width: 900px;
        width: 95%;
        max-height: 95vh;
        overflow-y: auto;
        position: relative;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.16);
    }
    
    .popup-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1.5rem 2rem;
        border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        background: #ffffff;
        border-radius: 8px 8px 0 0;
    }
    
    .popup-header h2 {
        color: #1A1A1A;
        margin: 0;
        font-size: 1.5rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }
    
    .close-btn {
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.12);
        color: #1A1A1A;
        padding: 0.5rem;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.1rem;
    }
    
    .close-btn:hover {
        background: rgba(0, 0, 0, 0.04);
        color: #1A1A1A;
        transform: scale(1.05);
    }
    
    .popup-content form {
        padding: 2rem;
    }
    
    .popup-content .form-section {
        margin-bottom: 2rem;
        padding: 1.5rem;
        background: #ffffff;
        border-radius: 8px;
        border: 1px solid rgba(0, 0, 0, 0.08);
    }
    
    .popup-content .form-section h3 {
        color: #007AFF;
        margin: 0 0 1.5rem 0;
        font-size: 1.2rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }
    
    .popup-content .form-group {
        margin-bottom: 1.5rem;
    }
    
    .popup-content .form-group label {
        display: block;
        color: #1A1A1A;
        font-size: 1rem;
        margin-bottom: 1rem;
        font-weight: 600;
    }
    
    .popup-content .form-group input[type="text"],
    .popup-content .form-group textarea,
    .popup-content .form-group select {
        width: 100%;
        padding: 1rem;
        border: 1px solid rgba(0, 0, 0, 0.12);
        border-radius: 8px;
        background: #ffffff;
        color: #1A1A1A;
        font-size: 1rem;
        font-family: inherit;
        transition: all 0.3s ease;
    }
    
    .popup-content .form-group input[type="text"]:focus,
    .popup-content .form-group textarea:focus,
    .popup-content .form-group select:focus {
        outline: none;
        border-color: #007AFF;
        background: #ffffff;
        box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.12);
    }
    
    .popup-content .form-group textarea {
        resize: vertical;
        min-height: 80px;
    }
    
    .popup-content .form-group small {
        display: block;
        color: rgba(26, 26, 26, 0.6);
        font-size: 0.8rem;
        margin-top: 0.5rem;
    }
    
    .popup-content .checkbox-group {
        display: flex;
        align-items: flex-start;
        gap: 1rem;
    }
    
    .popup-content .checkbox-label {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        color: #1A1A1A;
        font-size: 0.95rem;
        cursor: pointer;
        user-select: none;
    }
    
    .popup-content .checkbox-label input[type="checkbox"] {
        display: none;
    }
    
    .popup-content .checkmark {
        width: 18px;
        height: 18px;
        border: 2px solid rgba(0, 0, 0, 0.3);
        border-radius: 4px;
        background: #ffffff;
        position: relative;
        transition: all 0.3s ease;
    }
    
    .popup-content .checkbox-label input[type="checkbox"]:checked + .checkmark {
        background: #007AFF;
        border-color: #007AFF;
    }
    
    .popup-content .checkbox-label input[type="checkbox"]:checked + .checkmark::after {
        content: '‚úì';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        font-size: 12px;
        font-weight: bold;
    }
    
    .popup-content .file-upload-area {
        border: 2px dashed rgba(0, 0, 0, 0.2);
        border-radius: 8px;
        padding: 1.5rem;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        background: #ffffff;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.75rem;
    }
    
    .popup-content .file-upload-area:hover {
        border-color: #007AFF;
        background: rgba(0, 122, 255, 0.04);
    }
    
    .popup-content .file-upload-area i {
        font-size: 2rem;
        color: rgba(26, 26, 26, 0.5);
    }
    
    .popup-content .file-upload-area p {
        color: rgba(26, 26, 26, 0.85);
        margin: 0;
        font-size: 1rem;
        font-weight: 500;
    }
    
    .popup-content .file-upload-area small {
        color: rgba(255, 255, 255, 0.5);
        font-size: 0.85rem;
    }
    
    .popup-content .file-preview {
        position: relative;
        margin-top: 1rem;
        border-radius: 8px;
        overflow: hidden;
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.08);
    }
    
    .popup-content .file-preview img {
        width: 100%;
        max-height: 150px;
        object-fit: cover;
        display: block;
    }
    
    .popup-content .remove-file-btn {
        position: absolute;
        top: 0.5rem;
        right: 0.5rem;
        background: rgba(231, 76, 60, 0.9);
        border: none;
        color: white;
        padding: 0.5rem;
        border-radius: 50%;
        cursor: pointer;
        transition: all 0.3s ease;
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.8rem;
    }
    
    .popup-content .remove-file-btn:hover {
        background: rgba(231, 76, 60, 1);
        transform: scale(1.1);
    }
    
    .popup-content .form-actions {
        display: flex;
        gap: 1rem;
        justify-content: flex-end;
        margin-top: 2rem;
        padding-top: 2rem;
        border-top: 1px solid rgba(0, 0, 0, 0.08);
    }
    
    .popup-content .btn {
        padding: 1rem 2rem;
        border: none;
        border-radius: 8px;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.75rem;
        font-weight: 600;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        min-height: 50px;
    }
    
    .popup-content .btn-primary {
        background: #007AFF;
        color: white;
    }
    
    .popup-content .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
    }
    
    /* –°—Ç–∏–ª–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –∞–≤–∞—Ç–∞—Ä–∞ */
    .avatar-preview {
        margin-top: 15px;
        text-align: center;
        padding: 12px 15px;
        background: rgba(0, 122, 255, 0.08);
        border-radius: 8px;
        border: 1px solid rgba(0, 122, 255, 0.2);
    }
    
    .avatar-preview span {
        display: block;
        color: #007AFF;
        font-size: 14px;
        font-weight: 500;
        word-break: break-all;
    }
    
    .popup-content .btn-secondary {
        background: #ffffff;
        color: #1A1A1A;
        border: 1px solid rgba(0, 0, 0, 0.12);
    }
    
    .popup-content .btn-secondary:hover {
        background: rgba(0, 0, 0, 0.04);
        color: #1A1A1A;
        transform: translateY(-2px);
    }
    
    /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
    .notification {
        position: fixed;
        top: 2rem;
        right: 2rem;
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.12);
        border-radius: 8px;
        padding: 1rem 1.5rem;
        color: #1A1A1A;
        display: flex;
        align-items: center;
        gap: 0.75rem;
        z-index: 1001;
        transform: translateX(400px);
        transition: transform 0.3s ease;
        max-width: 400px;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.08);
    }
    
    .notification.show {
        transform: translateX(0);
    }
    
    .notification.success {
        border-color: rgba(46, 204, 113, 0.5);
        background: rgba(46, 204, 113, 0.1);
    }
    
    .notification.error {
        border-color: rgba(231, 76, 60, 0.5);
        background: rgba(231, 76, 60, 0.1);
    }
    
    .notification i {
        font-size: 1.2rem;
    }
    
    .notification.success i {
        color: #27ae60;
    }
    
    .notification.error i {
        color: #e74c3c;
    }
    
    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ø-–∞–ø–∞ */
    @media (max-width: 768px) {
        .popup-content {
            width: 95%;
            max-height: 95vh;
        }
        
        .popup-header {
            padding: 1rem 1.5rem;
        }
        
        .popup-header h2 {
            font-size: 1.3rem;
        }
        
        .popup-content form {
            padding: 1.5rem;
        }
        
        .popup-content .form-actions {
            flex-direction: column;
        }
        
        .popup-content .btn {
            width: 100%;
            justify-content: center;
        }
        
        .notification {
            right: 1rem;
            left: 1rem;
            max-width: none;
        }
    }
</style>
{% endblock %}
