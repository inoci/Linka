{% extends "base.html" %}

{% block title %}–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å {{ community.name }} - –õ–∏–Ω–∫–∞{% endblock %}

{% block content %}
<div class="edit-page">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
    <div class="page-header">
        <div class="header-content">
            <h1>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</h1>
            <p>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–∞—à–µ–≥–æ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</p>
        </div>
        <div class="header-actions">
            <a href="{{ url_for('community', community_id=community.id) }}" class="back-btn">
                <i class="fas fa-arrow-left"></i>
                –ù–∞–∑–∞–¥
            </a>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="edit-container">
        <aside class="edit-sidebar">
            <nav class="edit-menu">
                <a href="#section-basic" class="menu-link active"><i class="fas fa-info-circle"></i> –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</a>
                <a href="#section-advanced" class="menu-link"><i class="fas fa-cog"></i> –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</a>
            </nav>
        </aside>
        <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - —Ñ–æ—Ä–º—ã -->
        <div class="forms-column">
            <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
            <div class="form-card" id="section-basic">
                <div class="card-header">
                    <i class="fas fa-info-circle"></i>
                    <h3>–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                </div>
                
                <form method="POST" enctype="multipart/form-data" class="edit-form">
                    <div class="input-group">
                        <label for="name">–ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</label>
                        <input type="text" id="name" name="name" value="{{ community.name }}" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="description">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea id="description" name="description" rows="4" placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –≤–∞—à–µ–º —Å–æ–æ–±—â–µ—Å—Ç–≤–µ...">{{ community.description or '' }}</textarea>
                    </div>
                    
                    <div class="input-group">
                        <label>–¢–∏–ø —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</label>
                        <div class="toggle-group">
                            <label class="toggle-option">
                                <input type="radio" name="is_private" value="false" {% if not community.is_private %}checked{% endif %}>
                                <span class="toggle-label">
                                    <i class="fas fa-globe"></i>
                                    –ü—É–±–ª–∏—á–Ω–æ–µ
                                </span>
                            </label>
                            <label class="toggle-option">
                                <input type="radio" name="is_private" value="true" {% if community.is_private %}checked{% endif %}>
                                <span class="toggle-label">
                                    <i class="fas fa-lock"></i>
                                    –ü—Ä–∏–≤–∞—Ç–Ω–æ–µ
                                </span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label for="avatar">–ê–≤–∞—Ç–∞—Ä</label>
                        <div class="avatar-section">
                            {% if community.avatar %}
                                <div class="current-avatar">
                                    <img src="{{ url_for('static', filename=community.avatar) }}" alt="–¢–µ–∫—É—â–∏–π –∞–≤–∞—Ç–∞—Ä">
                                </div>
                            {% endif %}
                            <div class="file-input-wrapper">
                                <input type="file" id="avatar" name="avatar" accept="image/*">
                                <label for="avatar" class="file-input-label">–í—ã–±–µ—Ä–∏—Ç–µ –∞–≤–∞—Ç–∞—Ä</label>
                            </div>
                        </div>
                    </div>
                    
                    <button type="submit" class="submit-btn">
                        <i class="fas fa-save"></i>
                        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
                    </button>
                </form>
            </div>
            
            <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
            <div class="form-card" id="section-advanced">
                <div class="card-header">
                    <i class="fas fa-cog"></i>
                    <h3>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                </div>
                
                <form method="POST" enctype="multipart/form-data" class="edit-form">
                    <div class="input-group">
                        <label for="category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                        <select id="category" name="category">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                            <option value="–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏" {% if community.category == '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏' %}selected{% endif %}>üíª –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</option>
                            <option value="–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è" {% if community.category == '–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è' %}selected{% endif %}>üéÆ –†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</option>
                            <option value="–°–ø–æ—Ä—Ç" {% if community.category == '–°–ø–æ—Ä—Ç' %}selected{% endif %}>‚öΩ –°–ø–æ—Ä—Ç</option>
                            <option value="–ú—É–∑—ã–∫–∞" {% if community.category == '–ú—É–∑—ã–∫–∞' %}selected{% endif %}>üéµ –ú—É–∑—ã–∫–∞</option>
                            <option value="–ö–∏–Ω–æ" {% if community.category == '–ö–∏–Ω–æ' %}selected{% endif %}>üé¨ –ö–∏–Ω–æ</option>
                            <option value="–ö—É–ª–∏–Ω–∞—Ä–∏—è" {% if community.category == '–ö—É–ª–∏–Ω–∞—Ä–∏—è' %}selected{% endif %}>üç≥ –ö—É–ª–∏–Ω–∞—Ä–∏—è</option>
                            <option value="–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è" {% if community.category == '–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è' %}selected{% endif %}>‚úàÔ∏è –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è</option>
                            <option value="–ú–æ–¥–∞" {% if community.category == '–ú–æ–¥–∞' %}selected{% endif %}>üëó –ú–æ–¥–∞</option>
                            <option value="–ê–≤—Ç–æ" {% if community.category == '–ê–≤—Ç–æ' %}selected{% endif %}>üöó –ê–≤—Ç–æ</option>
                            <option value="–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ" {% if community.category == '–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ' %}selected{% endif %}>üìö –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</option>
                            <option value="–ó–¥–æ—Ä–æ–≤—å–µ" {% if community.category == '–ó–¥–æ—Ä–æ–≤—å–µ' %}selected{% endif %}>üè• –ó–¥–æ—Ä–æ–≤—å–µ</option>
                            <option value="–•–æ–±–±–∏" {% if community.category == '–•–æ–±–±–∏' %}selected{% endif %}>üé® –•–æ–±–±–∏</option>
                            <option value="–ë–∏–∑–Ω–µ—Å" {% if community.category == '–ë–∏–∑–Ω–µ—Å' %}selected{% endif %}>üíº –ë–∏–∑–Ω–µ—Å</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label for="website">–í–µ–±-—Å–∞–π—Ç</label>
                        <input type="url" id="website" name="website" value="{{ community.website or '' }}" placeholder="https://example.com">
                    </div>
                    
                    <div class="input-group">
                        <label for="phone">–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω</label>
                        <input type="tel" id="phone" name="phone" value="{{ community.phone or '' }}" placeholder="+7 (999) 123-45-67">
                    </div>
                    
                    <div class="input-group">
                        <label for="city">–ì–æ—Ä–æ–¥</label>
                        <select id="city" name="city">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥</option>
                            <option value="–ú–æ—Å–∫–≤–∞" {% if community.city == '–ú–æ—Å–∫–≤–∞' %}selected{% endif %}>–ú–æ—Å–∫–≤–∞</option>
                            <option value="–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥" {% if community.city == '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥' %}selected{% endif %}>–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥</option>
                            <option value="–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫" {% if community.city == '–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫' %}selected{% endif %}>–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫</option>
                            <option value="–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥" {% if community.city == '–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥' %}selected{% endif %}>–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥</option>
                            <option value="–ö–∞–∑–∞–Ω—å" {% if community.city == '–ö–∞–∑–∞–Ω—å' %}selected{% endif %}>–ö–∞–∑–∞–Ω—å</option>
                            <option value="–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥" {% if community.city == '–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥' %}selected{% endif %}>–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥</option>
                            <option value="–ß–µ–ª—è–±–∏–Ω—Å–∫" {% if community.city == '–ß–µ–ª—è–±–∏–Ω—Å–∫' %}selected{% endif %}>–ß–µ–ª—è–±–∏–Ω—Å–∫</option>
                            <option value="–°–∞–º–∞—Ä–∞" {% if community.city == '–°–∞–º–∞—Ä–∞' %}selected{% endif %}>–°–∞–º–∞—Ä–∞</option>
                            <option value="–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É" {% if community.city == '–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É' %}selected{% endif %}>–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É</option>
                            <option value="–£—Ñ–∞" {% if community.city == '–£—Ñ–∞' %}selected{% endif %}>–£—Ñ–∞</option>
                        </select>
                    </div>
                    
                    <button type="submit" class="submit-btn">
                        <i class="fas fa-save"></i>
                        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                    </button>
                </form>
            </div>
        </div>
        
        <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –±—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
        
    <!-- –†–∞–∑–¥–µ–ª —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ -->
    <div id="members-content" class="dynamic-content" style="display: none;">
        <div class="content-header">
            <h2><i class="fas fa-users"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏</h2>
            <button class="back-to-main" onclick="showMainContent()">
                <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥ –∫ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
            </button>
        </div>
        
        <div class="content-body">
            <div class="members-list">
                <h3>–¢–µ–∫—É—â–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏</h3>
                <div class="members-grid">
                    {% if members %}
                        {% for member in members %}
                        <div class="member-card">
                            <div class="member-avatar">
                                {% if member.user.avatar %}
                                    <img src="{{ member.user.avatar }}" alt="–ê–≤–∞—Ç–∞—Ä">
                                {% else %}
                                    <i class="fas fa-user"></i>
                                {% endif %}
                            </div>
                            <div class="member-info">
                                <h4>{{ member.user.username }}</h4>
                                <p>{{ member.role }}</p>
                            </div>
                            {% if member.role != 'admin' and community.creator_id == session['user_id'] %}
                            <button class="remove-member-btn" data-user-id="{{ member.user.id }}">
                                <i class="fas fa-user-minus"></i>
                            </button>
                            {% endif %}
                        </div>
                        {% endfor %}
                    {% else %}
                        <p class="no-members">–í —Å–æ–æ–±—â–µ—Å—Ç–≤–µ –ø–æ–∫–∞ –Ω–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    
    <!-- –†–∞–∑–¥–µ–ª —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞ -->
    <div id="create-post-content" class="dynamic-content" style="display: none;">
        <div class="content-header">
            <h2><i class="fas fa-newspaper"></i> –°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç</h2>
            <button class="back-to-main" onclick="showMainContent()">
                <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥ –∫ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
            </button>
        </div>
        
        <div class="content-body">
            <form method="POST" action="{{ url_for('create_community_post', community_id=community.id) }}" class="post-form">
                <div class="input-group">
                    <label for="post-content">–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–æ—Å—Ç–∞</label>
                    <textarea id="post-content" name="content" rows="6" placeholder="–ß—Ç–æ –Ω–æ–≤–æ–≥–æ –≤ –≤–∞—à–µ–º —Å–æ–æ–±—â–µ—Å—Ç–≤–µ?" required></textarea>
                </div>
                
                <div class="post-options">
                    <div class="option-group">
                        <label for="post-emoji">–≠–º–æ–¥–∑–∏</label>
                        <input type="text" id="post-emoji" name="emoji" placeholder="üòä">
                    </div>
                    
                    <div class="option-group">
                        <label for="post-location">–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ</label>
                        <input type="text" id="post-location" name="location" placeholder="–ì–¥–µ –≤—ã?">
                    </div>
                </div>
                
                <button type="submit" class="submit-btn">
                    <i class="fas fa-paper-plane"></i>
                    –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å
                </button>
            </form>
        </div>
    </div>
    
    <!-- –†–∞–∑–¥–µ–ª —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
    <div id="stats-content" class="dynamic-content" style="display: none;">
        <div class="content-header">
            <h2><i class="fas fa-chart-line"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</h2>
            <button class="back-to-main" onclick="showMainContent()">
                <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥ –∫ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
            </button>
        </div>
        
        <div class="content-body">
            <div class="stats-overview">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number">{{ member_count }}</div>
                        <div class="stat-label">–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-newspaper"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number">{{ post_count }}</div>
                        <div class="stat-label">–ü–æ—Å—Ç–æ–≤</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-comments"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number">{{ comment_count }}</div>
                        <div class="stat-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-heart"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number">{{ like_count }}</div>
                        <div class="stat-label">–õ–∞–π–∫–æ–≤</div>
                    </div>
                </div>
            </div>
            
                        <div class="activity-chart">
                <h3>–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∑–∞ –Ω–µ–¥–µ–ª—é</h3>
                <div class="chart-container">
                    <!-- –°—Ç–µ–∫–æ–≤–∞—è –æ–±–ª–∞—Å—Ç–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ -->
                    <div class="area-chart">
                        <canvas id="activityAreaChart" width="600" height="300"></canvas>
                    </div>
                    
                    <!-- –õ–µ–≥–µ–Ω–¥–∞ –¥–∏–∞–≥—Ä–∞–º–º—ã -->
                    <div class="chart-legend">
                        <div class="legend-item">
                            <div class="legend-color posts-color"></div>
                            <span>–ü–æ—Å—Ç—ã</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color comments-color"></div>
                            <span>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color likes-color"></div>
                            <span>–õ–∞–π–∫–∏</span>
                        </div>
                    </div>
                </div>
                
                <!-- –î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–∞–∑–±–∏–≤–∫–∞ –ø–æ –¥–Ω—è–º -->
                <div class="activity-breakdown">
                    <h4>–î–µ—Ç–∞–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –¥–Ω—è–º</h4>
                    <div class="breakdown-grid">
                        {% set days = ['–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', '–í—Ç–æ—Ä–Ω–∏–∫', '–°—Ä–µ–¥–∞', '–ß–µ—Ç–≤–µ—Ä–≥', '–ü—è—Ç–Ω–∏—Ü–∞', '–°—É–±–±–æ—Ç–∞', '–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ'] %}
                        {% for day in days %}
                            {% set day_data = weekly_activity[day] %}
                            <div class="breakdown-day">
                                <h5>{{ day }}</h5>
                                <div class="breakdown-stats">
                                    <div class="breakdown-stat">
                                        <span class="stat-label">–ü–æ—Å—Ç—ã:</span>
                                        <span class="stat-value posts-color">{{ day_data.posts }}</span>
                                    </div>
                                    <div class="breakdown-stat">
                                        <span class="stat-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:</span>
                                        <span class="stat-value comments-color">{{ day_data.comments }}</span>
                                    </div>
                                    <div class="breakdown-stat">
                                        <span class="stat-label">–õ–∞–π–∫–∏:</span>
                                        <span class="stat-value likes-color">{{ day_data.likes }}</span>
                                    </div>
                                    <div class="breakdown-stat total">
                                        <span class="stat-label">–í—Å–µ–≥–æ:</span>
                                        <span class="stat-value total-color">{{ day_data.posts + day_data.comments + day_data.likes }}</span>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –†–∞–∑–¥–µ–ª –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–∏–∑–∞–π–Ω–∞ -->
    <div id="comments-content" class="dynamic-content" style="display: none;">
        <div class="content-header">
            <h2><i class="fas fa-comments"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤</h2>
            <button class="back-to-main" onclick="showMainContent()">
                <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥ –∫ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
            </button>
        </div>
        
        <div class="content-body">
            <div class="comments-options">
                <!-- –û—Å–Ω–æ–≤–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ -->
                <div class="option-group">
                    <label class="main-toggle">
                        <input type="checkbox" id="comments-enabled" name="comments-enabled" 
                               {% if community.comments_enabled %}checked{% endif %}>
                        <span class="toggle-slider"></span>
                        <span class="toggle-label">–†–∞–∑—Ä–µ—à–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ —Å–æ–æ–±—â–µ—Å—Ç–≤–µ</span>
                    </label>
                    <p class="option-description">–í–∫–ª—é—á–∏—Ç–µ, —á—Ç–æ–±—ã —É—á–∞—Å—Ç–Ω–∏–∫–∏ –º–æ–≥–ª–∏ –æ—Å—Ç–∞–≤–ª—è—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –ø–æ—Å—Ç–∞–º</p>
                </div>
                
                <!-- –§–∏–ª—å—Ç—Ä—ã (–ø–æ—è–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤–∫–ª—é—á–µ–Ω—ã) -->
                <div id="filters-section" class="filters-section" style="display: none;">
                    <h3><i class="fas fa-filter"></i> –§–∏–ª—å—Ç—Ä—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤</h3>
                    
                    <div class="filter-group">
                        <label class="filter-option">
                            <input type="checkbox" id="profanity-filter" name="profanity-filter"
                                   {% if community.profanity_filter %}checked{% endif %}>
                            <span class="checkbox-custom"></span>
                            <span>–§–∏–ª—å—Ç—Ä –Ω–µ—Ü–µ–Ω–∑—É—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π</span>
                        </label>
                        <p class="filter-description">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å –º–∞—Ç–æ–º</p>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-option">
                            <input type="checkbox" id="hostile-filter" name="hostile-filter"
                                   {% if community.hostile_filter %}checked{% endif %}>
                            <span class="checkbox-custom"></span>
                            <span>–§–∏–ª—å—Ç—Ä –≤—Ä–∞–∂–¥–µ–±–Ω—ã—Ö –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–π</span>
                        </label>
                        <p class="filter-description">–ë–ª–æ–∫–∏—Ä—É–µ—Ç –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –∏ –æ—Å–∫–æ—Ä–±–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</p>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-option">
                            <input type="checkbox" id="keyword-filter" name="keyword-filter"
                                   {% if community.keyword_filter %}checked{% endif %}>
                            <span class="checkbox-custom"></span>
                            <span>–§–∏–ª—å—Ç—Ä –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º</span>
                        </label>
                        <p class="filter-description">–ë–ª–æ–∫–∏—Ä—É–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏</p>
                    </div>
                    
                    <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ -->
                    <div id="keywords-settings" class="keywords-settings" style="display: none;">
                        <h4><i class="fas fa-key"></i> –ó–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞</h4>
                        <div class="keywords-input">
                            <textarea id="banned-keywords" name="banned-keywords" 
                                      placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é&#10;–ù–∞–ø—Ä–∏–º–µ—Ä: —Å–ø–∞–º, —Ä–µ–∫–ª–∞–º–∞, –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ"
                                      rows="4">{{ community.banned_keywords or '' }}</textarea>
                            <p class="input-hint">–°–ª–æ–≤–∞ —Ä–∞–∑–¥–µ–ª—è—é—Ç—Å—è –∑–∞–ø—è—Ç—ã–º–∏. –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å —ç—Ç–∏–º–∏ —Å–ª–æ–≤–∞–º–∏ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è.</p>
                        </div>
                    </div>
                </div>
                
                <button class="submit-btn" onclick="saveCommentSettings()">
                    <i class="fas fa-save"></i>
                    –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
                </button>
            </div>
        </div>
    </div>
</div>

<style>
    /* –°—Ç–∏–ª–∏: —Å–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ —Å —Å–∏–Ω–∏–º–∏ –∞–∫—Ü–µ–Ω—Ç–∞–º–∏ */
    .edit-page {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;
        min-height: 100vh;
        color: #1A1A1A;
    }
    
    /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
    .page-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 3rem;
        padding: 2rem;
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
    }
    
    .header-content h1 {
        color: #1A1A1A;
        font-size: 2.5rem;
        font-weight: 700;
        margin: 0 0 0.5rem 0;
    }
    
    .header-content p {
        color: rgba(26, 26, 26, 0.8);
        font-size: 1.1rem;
        margin: 0;
    }
    
    .back-btn {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem 1.5rem;
        background: rgba(0, 122, 255, 0.08);
        color: #007AFF;
        text-decoration: none;
        border-radius: 8px;
        transition: all 0.3s ease;
        border: 1px solid rgba(0, 0, 0, 0.12);
        font-weight: 600;
    }
    
    .back-btn:hover {
        background: rgba(52, 152, 219, 0.3);
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(52, 152, 219, 0.4);
    }
    
    /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
    .edit-container {
        display: grid;
        grid-template-columns: 260px 1fr;
        gap: 2rem;
        align-items: start;
    }

    .edit-sidebar {
        position: sticky;
        top: 90px;
        height: fit-content;
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
        padding: 1rem;
    }

    .edit-menu { display: flex; flex-direction: column; gap: 0.5rem; }
    .menu-link {
        display: flex; align-items: center; gap: 0.6rem;
        padding: 0.6rem 0.8rem;
        border-radius: 8px;
        color: #1A1A1A; text-decoration: none;
        transition: all 0.2s ease;
    }
    .menu-link i { color: #007AFF; width: 18px; text-align: center; }
    .menu-link:hover { background: rgba(0,0,0,0.04); }
    .menu-link.active { background: rgba(0,122,255,0.1); color:#007AFF; }

    /* (—É–¥–∞–ª–µ–Ω—ã —Å—Ç–∏–ª–∏ —Ç–∞–±–æ–≤) */
    
    /* –ö–∞—Ä—Ç–æ—á–∫–∏ —Ñ–æ—Ä–º */
    .form-card {
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 8px;
        padding: 2rem;
        margin-bottom: 2rem;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
        transition: all 0.3s ease;
    }
    
    .form-card:hover {
        border-color: rgba(52, 152, 219, 0.4);
        box-shadow: 0 25px 50px rgba(52, 152, 219, 0.2);
        transform: translateY(-2px);
    }
    
    .card-header {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin-bottom: 2rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid rgba(0, 0, 0, 0.08);
    }
    
    .card-header i {
        font-size: 1.5rem;
        color: #007AFF;
    }
    
    .card-header h3 {
        color: #1A1A1A;
        font-size: 1.5rem;
        font-weight: 600;
        margin: 0;
    }
    
    /* –§–æ—Ä–º—ã */
    .edit-form {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
    }
    
    .input-group {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }
    
    .input-group label {
        color: #1A1A1A;
        font-weight: 600;
        font-size: 0.95rem;
    }
    
    .input-group input,
    .input-group textarea,
    .input-group select {
        padding: 1rem;
        border: 1px solid rgba(0, 0, 0, 0.12);
        border-radius: 8px;
        font-size: 1rem;
        transition: all 0.3s ease;
        background: #ffffff;
        color: #1A1A1A;
        font-family: inherit;
    }
    
    .input-group input:focus,
    .input-group textarea:focus,
    .input-group select:focus {
        outline: none;
        border-color: #007AFF;
        box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.12);
        transform: translateY(-1px);
        background: #ffffff;
    }
    
    .input-group input::placeholder,
    .input-group textarea::placeholder {
        color: rgba(26, 26, 26, 0.5);
    }
    
    .input-group textarea {
        resize: vertical;
        min-height: 100px;
    }
    
    /* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏ */
    .toggle-group {
        display: flex;
        gap: 1rem;
    }
    
    .toggle-option {
        flex: 1;
        cursor: pointer;
    }
    
    .toggle-option input[type="radio"] {
        display: none;
    }
    
    .toggle-label {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 1rem;
        border: 1px solid rgba(0, 0, 0, 0.12);
        border-radius: 8px;
        text-align: center;
        transition: all 0.3s ease;
        background: #ffffff;
        color: rgba(26, 26, 26, 0.8);
    }
    
    .toggle-option input[type="radio"]:checked + .toggle-label {
        border-color: #007AFF;
        background: rgba(0, 122, 255, 0.12);
        color: #1A1A1A;
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
    }
    
    /* –ê–≤–∞—Ç–∞—Ä */
    .avatar-section {
        display: flex;
        align-items: center;
        gap: 1rem;
    }
    
    .current-avatar img {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        object-fit: cover;
        border: 3px solid #ffffff;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }
    
    /* –ö–Ω–æ–ø–∫–∏ */
    .submit-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        padding: 1rem 2rem;
        background: #007AFF;
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-top: 1rem;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }
    
    .submit-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(52, 152, 219, 0.4);
        background: linear-gradient(135deg, #2980b9, #1f5f8b);
    }
    
    /* –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ */
    .actions-column {
        display: flex;
        flex-direction: column;
        gap: 2rem;
    }
    
    .quick-actions,
    .community-stats {
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 8px;
        padding: 2rem;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
        transition: all 0.3s ease;
    }
    
    .quick-actions:hover,
    .community-stats:hover {
        border-color: rgba(52, 152, 219, 0.4);
        transform: translateY(-2px);
    }
    
    .quick-actions h3,
    .community-stats h3 {
        color: #1A1A1A;
        font-size: 1.3rem;
        font-weight: 600;
        margin: 0 0 1.5rem 0;
        text-align: center;
    }
    
    .action-item {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1rem;
        margin-bottom: 1rem;
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 8px;
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
    }
    
    .action-item:hover {
        background: rgba(0, 0, 0, 0.03);
        border-color: rgba(0, 0, 0, 0.12);
        transform: translateX(5px);
    }
    
    .action-item i {
        font-size: 1.5rem;
        color: #007AFF;
        width: 40px;
        text-align: center;
    }
    
    .action-content h4 {
        color: #1A1A1A;
        font-size: 1rem;
        font-weight: 600;
        margin: 0 0 0.25rem 0;
    }
    
    .action-content p {
        color: rgba(26, 26, 26, 0.7);
        font-size: 0.9rem;
        margin: 0 0 0.5rem 0;
    }
    
    .action-btn {
        color: #007AFF;
        text-decoration: none;
        font-weight: 600;
        font-size: 0.9rem;
        transition: color 0.3s ease;
    }
    
    .action-btn:hover {
        color: #005FCC;
    }
    
    /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 1rem;
    }
    
    .stat-item {
        text-align: center;
        padding: 1rem;
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 8px;
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
    }
    
    .stat-item:hover {
        background: rgba(52, 152, 219, 0.1);
        border-color: rgba(52, 152, 219, 0.4);
        transform: translateY(-2px);
    }
    
    .stat-number {
        font-size: 2rem;
        font-weight: 700;
        color: #007AFF;
        margin-bottom: 0.5rem;
    }
    
    .stat-label {
        color: rgba(26, 26, 26, 0.7);
        font-size: 0.9rem;
        font-weight: 500;
    }
    
    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
    @media (max-width: 1024px) {
        .edit-container {
            grid-template-columns: 1fr;
        }
        
        .actions-column {
            order: -1;
        }
    }
    
    @media (max-width: 768px) {
        .edit-page {
            padding: 1rem;
        }
        
        .page-header {
            flex-direction: column;
            gap: 1rem;
            text-align: center;
        }
        
        .header-content h1 {
            font-size: 2rem;
        }
        
        .stats-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }
    
    /* –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ä–∞–∑–¥–µ–ª—ã */
    .dynamic-content {
        display: none;
        animation: fadeIn 0.3s ease;
    }
    
    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateX(20px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }
    
    .content-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
        padding: 1.5rem;
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
    }
    
    .content-header h2 {
        color: #1A1A1A;
        font-size: 1.8rem;
        font-weight: 600;
        margin: 0;
        display: flex;
        align-items: center;
        gap: 1rem;
    }
    
    .back-to-main {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem 1.2rem;
        background: #ffffff;
        color: #1A1A1A;
        border: 1px solid rgba(0, 0, 0, 0.12);
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.2s ease;
        font-weight: 600;
        text-decoration: none;
    }
    
    .back-to-main:hover {
        background: rgba(0, 0, 0, 0.04);
        border-color: rgba(0, 0, 0, 0.16);
        transform: translateY(-2px);
    }
    
    .content-body {
        padding: 0 1rem;
    }
    
    /* –°—Ç–∏–ª–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ */
    .members-list h3 {
        color: #1A1A1A;
        font-size: 1.5rem;
        margin-bottom: 1.5rem;
    }
    
    .members-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 1rem;
    }
    
    .member-card {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1rem;
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 8px;
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
    }
    
    .member-card:hover {
        background: rgba(0, 0, 0, 0.03);
        border-color: rgba(0, 0, 0, 0.12);
        transform: translateY(-2px);
    }
        
    .member-avatar {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: linear-gradient(45deg, #007AFF, #66A3FF);
        display: flex;
        align-items: center;
        justify-content: center;
        color: #ffffff;
        font-size: 1.5rem;
        overflow: hidden;
    }
    
    .member-info h4 {
        color: #1A1A1A;
        margin: 0 0 0.25rem 0;
        font-size: 1.1rem;
    }
    
    .member-info p {
        color: rgba(26, 26, 26, 0.7);
        margin: 0;
        font-size: 0.9rem;
    }
    
    .remove-member-btn {
        background: rgba(231, 76, 60, 0.2);
        border: 1px solid rgba(231, 76, 60, 0.4);
        color: #e74c3c;
        padding: 0.5rem;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-left: auto;
    }
    
    .remove-member-btn:hover {
        background: rgba(231, 76, 60, 0.3);
        border-color: rgba(231, 76, 60, 0.6);
    }
    
    /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞ */
    .post-form {
        max-width: 800px;
        margin: 0 auto;
    }
    
    .post-options {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
    .option-group {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }
    
    .option-group label {
        color: #1A1A1A;
        font-weight: 600;
        font-size: 0.95rem;
    }
    
    .option-group input {
        padding: 0.75rem;
        border: 1px solid rgba(0, 0, 0, 0.12);
        border-radius: 8px;
        background: #ffffff;
        color: #1A1A1A;
        font-size: 0.9rem;
    }
    
    /* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
    .stats-overview {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
        }
        
    .stat-card {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1.5rem;
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 8px;
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
    }
    
    .stat-card:hover {
        background: rgba(0, 0, 0, 0.03);
        border-color: rgba(0, 0, 0, 0.12);
        transform: translateY(-3px);
    }
    
    .stat-icon {
        width: 60px;
        height: 60px;
        background: rgba(0, 122, 255, 0.1);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #007AFF;
        font-size: 1.5rem;
    }
    
    .stat-content .stat-number {
        font-size: 2.5rem;
        font-weight: 700;
        color: #007AFF;
        margin: 0;
    }
    
    .stat-content .stat-label {
        color: rgba(26, 26, 26, 0.7);
        font-size: 0.9rem;
        margin: 0;
    }
    
    .activity-chart {
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 8px;
        padding: 2rem;
        text-align: center;
        }
        
    .activity-chart h3 {
        color: #1A1A1A;
        margin-bottom: 1rem;
    }
    
    .chart-placeholder {
        color: rgba(26, 26, 26, 0.6);
        font-style: italic;
        padding: 2rem;
    }
    
    /* –°—Ç–∏–ª–∏ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–∏–∑–∞–π–Ω–∞ */
    .design-options {
        max-width: 600px;
        margin: 0 auto;
    }
    
    .color-schemes,
    .font-size-options {
        display: flex;
        gap: 1rem;
        margin-bottom: 1.5rem;
    }
    
    .color-option,
    .font-option {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.5rem;
        cursor: pointer;
        padding: 1rem;
        border: 2px solid rgba(52, 152, 219, 0.3);
        border-radius: 12px;
        transition: all 0.3s ease;
        background: rgba(255, 255, 255, 0.03);
    }
    
    .color-option:hover,
    .font-option:hover {
        border-color: rgba(52, 152, 219, 0.5);
        background: rgba(52, 152, 219, 0.1);
    }
    
    .color-option input[type="radio"]:checked + .color-preview + span,
    .font-option input[type="radio"]:checked + span {
        color: #3498db;
        font-weight: 600;
        }
        
        .color-option input[type="radio"],
        .font-option input[type="radio"] {
            display: none;
        }
        
        .color-preview {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .default-theme {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }
        
        .dark-theme {
            background: linear-gradient(135deg, #2c3e50, #34495e);
        }
        
        .light-theme {
            background: linear-gradient(135deg, #ecf0f1, #bdc3c7);
        }
        
    .color-option span:last-child,
    .font-option span {
            color: rgba(26, 26, 26, 0.8);
            font-size: 0.9rem;
            text-align: center;
        }
        
        /* ===== –°–¢–ò–õ–ò –î–õ–Ø –°–¢–ï–ö–û–í–û–ô –û–ë–õ–ê–°–¢–ù–û–ô –î–ò–ê–ì–†–ê–ú–ú–´ ===== */
        
        .activity-chart {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(52, 152, 219, 0.3);
            border-radius: 16px;
            padding: 2rem;
            margin-top: 2rem;
        }
        
        .activity-chart h3 {
            color: #ffffff;
            margin-bottom: 1.5rem;
            font-size: 1.3rem;
            text-align: center;
        }
        
        .chart-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
        }
        
        .area-chart {
            position: relative;
            width: 600px;
            height: 300px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 12px;
            padding: 1rem;
        }
        
        .chart-legend {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-top: 1rem;
        }
        
    .legend-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: rgba(26, 26, 26, 0.8);
        font-size: 0.9rem;
        padding: 0.5rem 1rem;
        background: rgba(0, 0, 0, 0.03);
        border-radius: 8px;
        transition: all 0.3s ease;
    }
        
    .legend-item:hover {
        background: rgba(0, 0, 0, 0.06);
        transform: translateY(-2px);
    }
        
        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 3px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        
        .posts-color {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }
        
        .comments-color {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }
        
        .likes-color {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }
        
        /* ===== –°–¢–ò–õ–ò –î–õ–Ø –î–ï–¢–ê–õ–¨–ù–û–ô –†–ê–ó–ë–ò–í–ö–ò ===== */
        
        .activity-breakdown {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid rgba(52, 152, 219, 0.3);
        }
        
        .activity-breakdown h4 {
            color: #ffffff;
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
            text-align: center;
        }
        
        .breakdown-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }
        
        .breakdown-day {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(52, 152, 219, 0.2);
            border-radius: 12px;
            padding: 1rem;
            transition: all 0.3s ease;
        }
        
        .breakdown-day:hover {
            background: rgba(52, 152, 219, 0.1);
            border-color: rgba(52, 152, 219, 0.4);
            transform: translateY(-2px);
        }
        
        .breakdown-day h5 {
            color: #ffffff;
            margin: 0 0 1rem 0;
            font-size: 1rem;
            text-align: center;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(52, 152, 219, 0.3);
        }
        
        .breakdown-stats {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .breakdown-stat {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.25rem 0;
        }
        
        .stat-label {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.85rem;
        }
        
        .stat-value {
            font-weight: 600;
            font-size: 0.9rem;
            padding: 0.2rem 0.5rem;
            border-radius: 8px;
            min-width: 30px;
            text-align: center;
        }
        
        .stat-value.posts-color {
            background: rgba(52, 152, 219, 0.2);
            color: #3498db;
        }
        
        .stat-value.comments-color {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
        }
        
        .stat-value.likes-color {
            background: rgba(243, 156, 18, 0.2);
            color: #f39c12;
        }
        
        .stat-value.total-color {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
            font-weight: 700;
        }
    /* –£–ª—É—á—à–∞–µ–º —É–¥–æ–±—Å—Ç–≤–æ: —Å–µ—Ç–∫–∞ —Ñ–æ—Ä–º –æ–¥–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ –Ω–∞ —É–∑–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö */
    @media (max-width: 900px) {
        .edit-container { grid-template-columns: 1fr; }
    }
</style>

<!-- –î–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ (JSON) -->
<script id="weekly-activity-data" type="application/json">{{ weekly_activity|tojson }}</script>

<script>
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º
    document.querySelectorAll('.edit-form').forEach(form => {
        form.addEventListener('submit', function(e) {
            const submitBtn = this.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...';
            submitBtn.disabled = true;
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }, 3000);
        });
    });
    
    // –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∞–≤–∞—Ç–∞—Ä–∞
    document.getElementById('avatar').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const currentAvatar = document.querySelector('.current-avatar img');
                if (currentAvatar) {
                    currentAvatar.src = e.target.result;
                } else {
                    // –ï—Å–ª–∏ –∞–≤–∞—Ç–∞—Ä–∞ –µ—â–µ –Ω–µ—Ç, —Å–æ–∑–¥–∞–µ–º –µ–≥–æ
                    const avatarSection = document.querySelector('.avatar-section');
                    const newAvatar = document.createElement('div');
                    newAvatar.className = 'current-avatar';
                    newAvatar.innerHTML = `<img src="${e.target.result}" alt="–¢–µ–∫—É—â–∏–π –∞–≤–∞—Ç–∞—Ä">`;
                    avatarSection.insertBefore(newAvatar, avatarSection.querySelector('.file-input-wrapper'));
                }
            };
            reader.readAsDataURL(file);
        }
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã —Å –∞–≤–∞—Ç–∞—Ä–æ–º
    document.querySelector('form[enctype="multipart/form-data"]').addEventListener('submit', function(e) {
        const avatarInput = document.getElementById('avatar');
        if (avatarInput.files.length > 0) {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            const submitBtn = this.querySelector('.submit-btn');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞...';
            submitBtn.disabled = true;
            
            // –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ–º –∞–≤–∞—Ç–∞—Ä
            setTimeout(() => {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∞–≤–∞—Ç–∞—Ä –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
                const currentAvatar = document.querySelector('.current-avatar img');
                if (currentAvatar && avatarInput.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        currentAvatar.src = e.target.result;
                    };
                    reader.readAsDataURL(avatarInput.files[0]);
                }
            }, 2000);
        }
    });
    
    // Sidebar: –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–µ–∫—Ü–∏–π –±–µ–∑ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
    document.addEventListener('DOMContentLoaded', function() {
        const links = Array.from(document.querySelectorAll('.edit-sidebar .menu-link'));
        const basicCard = document.getElementById('section-basic');
        const advancedCard = document.getElementById('section-advanced');

        function showCard(target) {
            if (!basicCard || !advancedCard) return;
            const isAdvanced = target === 'advanced';
            basicCard.style.display = isAdvanced ? 'none' : '';
            advancedCard.style.display = isAdvanced ? '' : 'none';
            const activeHref = isAdvanced ? '#section-advanced' : '#section-basic';
            links.forEach(l => l.classList.toggle('active', l.getAttribute('href') === activeHref));
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ —Ö—ç—à—É URL
        if (location.hash === '#section-advanced') {
            showCard('advanced');
        } else {
            showCard('basic');
        }

        links.forEach(link => link.addEventListener('click', function(e) {
            const href = this.getAttribute('href');
            if (href === '#section-basic' || href === '#section-advanced') {
                e.preventDefault();
                showCard(href === '#section-advanced' ? 'advanced' : 'basic');
                try { history.replaceState(null, '', href); } catch (_) {}
            }
        }));
    });

    // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    document.addEventListener('DOMContentLoaded', function() {
        const elements = document.querySelectorAll('.form-card, .quick-actions, .community-stats');
        elements.forEach((el, index) => {
            setTimeout(() => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(20px)';
                el.style.transition = 'all 0.6s ease';
                
                setTimeout(() => {
                    el.style.opacity = '1';
                    el.style.transform = 'translateY(0)';
                }, 100);
            }, index * 200);
        });
    });
    
    // ===== –°–¢–ï–ö–û–í–ê–Ø –û–ë–õ–ê–°–¢–ù–ê–Ø –î–ò–ê–ì–†–ê–ú–ú–ê =====
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ —Å—Ç–µ–∫–æ–≤–æ–π –æ–±–ª–∞—Å—Ç–Ω–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã
    function drawAreaChart() {
        const canvas = document.getElementById('activityAreaChart');
        if (!canvas) {
            console.log('Canvas –Ω–µ –Ω–∞–π–¥–µ–Ω');
            return;
        }
        
        console.log('–ù–∞—á–∏–Ω–∞–µ–º –æ—Ç—Ä–∏—Å–æ–≤–∫—É –¥–∏–∞–≥—Ä–∞–º–º—ã...');
        
        const ctx = canvas.getContext('2d');
        const width = canvas.width;
        const height = canvas.height;
        const padding = 40;
        const chartWidth = width - 2 * padding;
        const chartHeight = height - 2 * padding;
        
        // –û—á–∏—â–∞–µ–º canvas
        ctx.clearRect(0, 0, width, height);
        
        // –î–∞–Ω–Ω—ã–µ –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º—ã (–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏)
        const weeklyActivity = JSON.parse(document.getElementById('weekly-activity-data')?.textContent || '{}');
        const data = [
            { day: '–ü–Ω', posts: (weeklyActivity['–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫']||{}).posts || 0, comments: (weeklyActivity['–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫']||{}).comments || 0, likes: (weeklyActivity['–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫']||{}).likes || 0 },
            { day: '–í—Ç', posts: (weeklyActivity['–í—Ç–æ—Ä–Ω–∏–∫']||{}).posts || 0, comments: (weeklyActivity['–í—Ç–æ—Ä–Ω–∏–∫']||{}).comments || 0, likes: (weeklyActivity['–í—Ç–æ—Ä–Ω–∏–∫']||{}).likes || 0 },
            { day: '–°—Ä', posts: (weeklyActivity['–°—Ä–µ–¥–∞']||{}).posts || 0, comments: (weeklyActivity['–°—Ä–µ–¥–∞']||{}).comments || 0, likes: (weeklyActivity['–°—Ä–µ–¥–∞']||{}).likes || 0 },
            { day: '–ß—Ç', posts: (weeklyActivity['–ß–µ—Ç–≤–µ—Ä–≥']||{}).posts || 0, comments: (weeklyActivity['–ß–µ—Ç–≤–µ—Ä–≥']||{}).comments || 0, likes: (weeklyActivity['–ß–µ—Ç–≤–µ—Ä–≥']||{}).likes || 0 },
            { day: '–ü—Ç', posts: (weeklyActivity['–ü—è—Ç–Ω–∏—Ü–∞']||{}).posts || 0, comments: (weeklyActivity['–ü—è—Ç–Ω–∏—Ü–∞']||{}).comments || 0, likes: (weeklyActivity['–ü—è—Ç–Ω–∏—Ü–∞']||{}).likes || 0 },
            { day: '–°–±', posts: (weeklyActivity['–°—É–±–±–æ—Ç–∞']||{}).posts || 0, comments: (weeklyActivity['–°—É–±–±–æ—Ç–∞']||{}).comments || 0, likes: (weeklyActivity['–°—É–±–±–æ—Ç–∞']||{}).likes || 0 },
            { day: '–í—Å', posts: (weeklyActivity['–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ']||{}).posts || 0, comments: (weeklyActivity['–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ']||{}).comments || 0, likes: (weeklyActivity['–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ']||{}).likes || 0 }
        ];
        
        console.log('–î–∞–Ω–Ω—ã–µ –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º—ã:', data);
        
        // –ù–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
        const maxValue = Math.max(...data.map(d => d.posts + d.comments + d.likes));
        const scale = maxValue > 0 ? chartHeight / maxValue : 1;
        
        console.log('–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:', maxValue, '–ú–∞—Å—à—Ç–∞–±:', scale);
        
        // –†–∏—Å—É–µ–º —Å–µ—Ç–∫—É
        ctx.strokeStyle = 'rgba(52, 152, 219, 0.2)';
        ctx.lineWidth = 1;
        
        // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏ —Å–µ—Ç–∫–∏
        for (let i = 0; i <= 5; i++) {
            const y = padding + (i * chartHeight / 5);
            ctx.beginPath();
            ctx.moveTo(padding, y);
            ctx.lineTo(width - padding, y);
            ctx.stroke();
        }
        
        // –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏ —Å–µ—Ç–∫–∏
        for (let i = 0; i < data.length; i++) {
            const x = padding + (i * chartWidth / (data.length - 1));
            ctx.beginPath();
            ctx.moveTo(x, padding);
            ctx.lineTo(x, height - padding);
            ctx.stroke();
        }
        
        // –†–∏—Å—É–µ–º –æ–±–ª–∞—Å—Ç–∏
        const colors = {
            posts: '#3498db',
            comments: '#e74c3c',
            likes: '#f39c12'
        };
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è –æ–±–ª–∞—Å—Ç–∏
        function drawArea(values, color, offset = 0) {
            ctx.beginPath();
            
            // –ù–∞—á–∏–Ω–∞–µ–º —Å –ª–µ–≤–æ–≥–æ –∫—Ä–∞—è
            ctx.moveTo(padding, height - padding);
            
            // –†–∏—Å—É–µ–º –≤–µ—Ä—Ö–Ω—é—é –ª–∏–Ω–∏—é
            for (let i = 0; i < data.length; i++) {
                const x = padding + (i * chartWidth / (data.length - 1));
                const totalValue = data[i].posts + data[i].comments + data[i].likes;
                const y = height - padding - (totalValue * scale);
                ctx.lineTo(x, y);
            }
            
            // –ó–∞–º—ã–∫–∞–µ–º –æ–±–ª–∞—Å—Ç—å
            ctx.lineTo(width - padding, height - padding);
            ctx.closePath();
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º –æ–±–ª–∞—Å—Ç—å
            const gradient = ctx.createLinearGradient(0, padding, 0, height - padding);
            gradient.addColorStop(0, color);
            gradient.addColorStop(1, adjustBrightness(color, -50));
            
            ctx.fillStyle = gradient;
            ctx.fill();
            
            // –†–∏—Å—É–µ–º –æ–±–≤–æ–¥–∫—É
            ctx.strokeStyle = color;
            ctx.lineWidth = 2;
            ctx.stroke();
        }
        
        // –†–∏—Å—É–µ–º –æ–±–ª–∞—Å—Ç–∏ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ (—Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö)
        drawArea(data.map(d => d.posts), colors.posts);
        drawArea(data.map(d => d.posts + d.comments), colors.comments);
        drawArea(data.map(d => d.posts + d.comments + d.likes), colors.likes);
        
        // –†–∏—Å—É–µ–º –ø–æ–¥–ø–∏—Å–∏ –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏
        ctx.fillStyle = 'rgba(26, 26, 26, 0.8)';
        ctx.font = '14px Arial';
        ctx.textAlign = 'center';
        
        for (let i = 0; i < data.length; i++) {
            const x = padding + (i * chartWidth / (data.length - 1));
            const y = height - padding + 20;
            ctx.fillText(data[i].day, x, y);
        }
        
        // –†–∏—Å—É–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –æ–±–ª–∞—Å—Ç—è—Ö
        ctx.font = '12px Arial';
        ctx.fillStyle = 'rgba(26, 26, 26, 0.9)';
        
        for (let i = 0; i < data.length; i++) {
            const x = padding + (i * chartWidth / (data.length - 1));
            
            // –ü–æ—Å—Ç—ã
            if (data[i].posts > 0) {
                const y = height - padding - (data[i].posts * scale / 2);
                ctx.fillText(data[i].posts.toString(), x, y);
            }
            
            // –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
            if (data[i].comments > 0) {
                const y = height - padding - (data[i].posts * scale) - (data[i].comments * scale / 2);
                ctx.fillText(data[i].comments.toString(), x, y);
            }
            
            // –õ–∞–π–∫–∏
            if (data[i].likes > 0) {
                const y = height - padding - (data[i].posts * scale) - (data[i].comments * scale) - (data[i].likes * scale / 2);
                ctx.fillText(data[i].likes.toString(), x, y);
            }
        }
        
        console.log('–î–∏–∞–≥—Ä–∞–º–º–∞ –æ—Ç—Ä–∏—Å–æ–≤–∞–Ω–∞!');
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —è—Ä–∫–æ—Å—Ç–∏ —Ü–≤–µ—Ç–∞
    function adjustBrightness(hex, percent) {
        const num = parseInt(hex.replace('#', ''), 16);
        const amt = Math.round(2.55 * percent);
        const R = (num >> 16) + amt;
        const G = (num >> 8 & 0x00FF) + amt;
        const B = (num & 0x0000FF) + amt;
        return '#' + (0x1000000 + (R < 255 ? R < 1 ? 0 : R : 255) * 0x10000 +
            (G < 255 ? G < 1 ? 0 : G : 255) * 0x100 +
            (B < 255 ? B < 1 ? 0 : B : 255)).toString(16).slice(1);
    }
    
    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ —Ä–∞–∑–¥–µ–ª–∞–º–∏
    function showSection(sectionName) {
        // –°–∫—Ä—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç
        const mainContent = document.querySelector('.edit-container');
        mainContent.style.display = 'none';
        
        // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ä–∞–∑–¥–µ–ª—ã
        hideAllDynamicContent();
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π —Ä–∞–∑–¥–µ–ª
        const sectionId = sectionName + '-content';
        const section = document.getElementById(sectionId);
        
        if (section) {
            section.style.display = 'block';
            // no-op for sidebar
            
            // –ï—Å–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, –æ—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –¥–∏–∞–≥—Ä–∞–º–º—É
            if (sectionName === 'stats') {
                setTimeout(() => {
                    drawAreaChart();
                }, 100);
            }
        }
    }
    
    function showMainContent() {
        // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ä–∞–∑–¥–µ–ª—ã
        hideAllDynamicContent();
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç
        const mainContent = document.querySelector('.edit-container');
        mainContent.style.display = 'grid';
        // no-op for sidebar
    }
    
    function hideAllDynamicContent() {
        const sections = document.querySelectorAll('.dynamic-content');
        sections.forEach(section => {
            section.style.display = 'none';
        });
    }
    
    // –£–¥–∞–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞
    function removeMember(userId) {
        if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∏–∑ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞?')) {
            // –ó–¥–µ—Å—å –±—É–¥–µ—Ç AJAX –∑–∞–ø—Ä–æ—Å –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∞
            fetch(`/remove_member/1/${userId}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–ª–∏ —É–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –∏–∑ DOM
                    location.reload();
                } else {
                    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞: ' + data.message);
                }
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞:', error);
                alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞');
            });
        }
    }

    // –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª–∏–∫–∞ –ø–æ –∫–Ω–æ–ø–∫–∞–º —É–¥–∞–ª–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∞ (–±–µ–∑ inline-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)
    document.addEventListener('click', function(e) {
        const btn = e.target.closest('.remove-member-btn');
        if (btn) {
            const userId = btn.getAttribute('data-user-id');
            if (userId) removeMember(userId);
        }
    });
    
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
    function saveCommentSettings() {
        const commentsEnabled = document.getElementById('comments-enabled').checked;
        const profanityFilter = document.getElementById('profanity-filter').checked;
        const hostileFilter = document.getElementById('hostile-filter').checked;
        const keywordFilter = document.getElementById('keyword-filter').checked;
        const bannedKeywords = document.getElementById('banned-keywords').value;
        
        // –ó–¥–µ—Å—å –±—É–¥–µ—Ç AJAX –∑–∞–ø—Ä–æ—Å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
        fetch('/save_comment_settings', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                commentsEnabled: commentsEnabled,
                profanityFilter: profanityFilter,
                hostileFilter: hostileFilter,
                keywordFilter: keywordFilter,
                bannedKeywords: bannedKeywords
            })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
            } else {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫: ' + data.message);
            }
        })
        .catch(error => {
            console.error('–û—à–∏–±–∫–∞:', error);
            alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫');
        });
    }
    
    // –ü–æ–ª—É—á–∞–µ–º ID —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ –∏–∑ URL (–ø–æ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞—Ç–∏—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
    const communityId = '1';
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —Ñ–∞–π–ª–∞ –∞–≤–∞—Ç–∞—Ä–∞
    document.addEventListener('DOMContentLoaded', function() {
        const avatarInput = document.getElementById('avatar');
        
        if (avatarInput) {
            avatarInput.addEventListener('change', function() {
                const label = this.nextElementSibling;
                if (this.files.length > 0) {
                    label.textContent = this.files[0].name;
                } else {
                    label.textContent = '–í—ã–±–µ—Ä–∏—Ç–µ –∞–≤–∞—Ç–∞—Ä';
                }
            });
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
        const commentsEnabled = document.getElementById('comments-enabled');
        if (commentsEnabled) {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∏–ª—å—Ç—Ä—ã —Å—Ä–∞–∑—É, –µ—Å–ª–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —É–∂–µ –≤–∫–ª—é—á–µ–Ω—ã
            const filtersSection = document.getElementById('filters-section');
            if (commentsEnabled.checked) {
                filtersSection.style.display = 'block';
            }
            
            commentsEnabled.addEventListener('change', function() {
                if (this.checked) {
                    filtersSection.style.display = 'block';
                } else {
                    filtersSection.style.display = 'none';
                }
            });
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
        const keywordFilter = document.getElementById('keyword-filter');
        if (keywordFilter) {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ —Å—Ä–∞–∑—É, –µ—Å–ª–∏ —Ñ–∏–ª—å—Ç—Ä —É–∂–µ –≤–∫–ª—é—á–µ–Ω
            const keywordsSettings = document.getElementById('keywords-settings');
            if (keywordFilter.checked) {
                keywordsSettings.style.display = 'block';
            }
            
            keywordFilter.addEventListener('change', function() {
                if (this.checked) {
                    keywordsSettings.style.display = 'block';
                } else {
                    keywordsSettings.style.display = 'none';
                }
            });
        }
    });
</script>
{% endblock %}
