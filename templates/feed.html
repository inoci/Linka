{% extends "base.html" %}

{% block title %}–õ–µ–Ω—Ç–∞ - –õ–∏–Ω–∫–∞{% endblock %}

{% block content %}
<div class="feed-layout">
    <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ —Å –ø–æ—Å—Ç–∞–º–∏ -->
    <div class="posts-column">


        <!-- –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ -->
        <div class="create-post-section">
            <div class="create-post-card">
                <div class="create-post-header">
            <div class="user-avatar-large">
                        {% if session.get('avatar') %}
                            <img src="{{ url_for('static', filename=session.get('avatar')) }}" alt="–ê–≤–∞—Ç–∞—Ä" style="width:100%;height:100%;object-fit:cover;border-radius:50%;">
                        {% else %}
                            {{ session.username[0].upper() }}
                        {% endif %}
                    </div>
                    <div class="create-post-info">
                        <h3>–ß—Ç–æ —É –≤–∞—Å –Ω–æ–≤–æ–≥–æ, {{ session.username }}?</h3>
                        <p>–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å–≤–æ–∏–º–∏ –º—ã—Å–ª—è–º–∏ —Å –¥—Ä—É–∑—å—è–º–∏</p>
                    </div>
                </div>
                
                <form method="POST" action="{{ url_for('create_post') }}" class="create-post-form" enctype="multipart/form-data">
        <div class="form-group">
                         <textarea name="content" class="post-textarea" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ..." rows="4" required></textarea>
                         
                         <!-- –°–∫—Ä—ã—Ç—ã–µ –ø–æ–ª—è –¥–ª—è –º–µ–¥–∏–∞ -->
                         <input type="hidden" name="emoji" id="emoji-field" value="">
                         <input type="hidden" name="location" id="location-field" value="">
                         <input type="hidden" name="location_name" id="location-name-field" value="">
                         
                         <!-- –ü–æ–ª–µ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è -->
                         <input type="file" name="image" id="image-input" accept="image/*" style="display: none;">
                         
                         <!-- –ü–æ–ª–µ –¥–ª—è –≤–∏–¥–µ–æ -->
                         <input type="file" name="video" id="video-input" accept="video/*" style="display: none;">
                         
                         <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Å—Ç–∞ -->
                         <div class="post-settings" style="display: none;">
                             <div class="setting-group">
                                 <label for="visibility">–í–∏–¥–∏–º–æ—Å—Ç—å:</label>
                                 <select name="visibility" id="visibility" class="post-select">
                                     <option value="public">–ü—É–±–ª–∏—á–Ω—ã–π</option>
                                     <option value="friends">–¢–æ–ª—å–∫–æ –¥—Ä—É–∑—å—è</option>
                                     <option value="private">–ü—Ä–∏–≤–∞—Ç–Ω—ã–π</option>
                                 </select>
        </div>
                             
                             <div class="setting-group">
                                 <label for="category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
                                 <select name="category" id="category" class="post-select">
                                     <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                                     <option value="–û–±—â–µ–µ">–û–±—â–µ–µ</option>
                                     <option value="–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</option>
                                     <option value="–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è">–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</option>
                                     <option value="–°–ø–æ—Ä—Ç">–°–ø–æ—Ä—Ç</option>
                                     <option value="–ú—É–∑—ã–∫–∞">–ú—É–∑—ã–∫–∞</option>
                                     <option value="–ö–∏–Ω–æ">–ö–∏–Ω–æ</option>
                                     <option value="–ö—É–ª–∏–Ω–∞—Ä–∏—è">–ö—É–ª–∏–Ω–∞—Ä–∏—è</option>
                                     <option value="–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è">–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è</option>
                                     <option value="–ú–æ–¥–∞">–ú–æ–¥–∞</option>
                                     <option value="–ê–≤—Ç–æ">–ê–≤—Ç–æ</option>
                                 </select>
                             </div>
                             
                             <div class="setting-group">
                                 <label for="tags">–¢–µ–≥–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):</label>
                                 <input type="text" name="tags" id="tags" class="post-input" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏, –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ">
                             </div>
                         </div>
                         
                         <!-- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è -->
                         <div id="image-preview" class="image-preview" style="display: none;">
                             <img id="preview-img" src="" alt="–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä">
                             <button type="button" class="remove-image-btn" onclick="removeImage()">
                                 <i class="fas fa-times"></i>
                             </button>
                         </div>
                         
                         <!-- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –≤–∏–¥–µ–æ -->
                         <div id="video-preview" class="video-preview" style="display: none;">
                             <video id="preview-video" controls>
                                 <source id="video-source" src="" type="video/mp4">
                                 –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
                             </video>
                             <button type="button" class="remove-video-btn" onclick="removeVideo()">
                                 <i class="fas fa-times"></i>
                             </button>
                         </div>
                         
                         <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —ç–º–æ–¥–∑–∏ -->
                         <div id="emoji-preview" class="emoji-preview" style="display: none;">
                             <span id="selected-emoji"></span>
                             <button type="button" class="remove-emoji-btn" onclick="removeEmoji()">
                                 <i class="fas fa-times"></i>
                             </button>
                         </div>
                         
                         <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ -->
                         <div id="location-preview" class="location-preview" style="display: none;">
                             <i class="fas fa-map-marker-alt"></i>
                             <span id="selected-location"></span>
                             <button type="button" class="remove-location-btn" onclick="removeLocation()">
                                 <i class="fas fa-times"></i>
                             </button>
                         </div>
                     </div>
                     <div class="form-actions">
                         <div class="post-options">
                             <button type="button" class="option-btn" title="–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ" onclick="addImage()">
                                 <i class="fas fa-image"></i>
                             </button>
                             <button type="button" class="option-btn" title="–î–æ–±–∞–≤–∏—Ç—å –≤–∏–¥–µ–æ" onclick="addVideo()">
                                 <i class="fas fa-video"></i>
                             </button>
                             <button type="button" class="option-btn" title="–í—ã–±—Ä–∞—Ç—å —ç–º–æ–¥–∑–∏" onclick="showEmojiPicker()">
                                 <i class="fas fa-smile"></i>
                             </button>
                             <button type="button" class="option-btn" title="–î–æ–±–∞–≤–∏—Ç—å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ" onclick="addLocation()">
                                 <i class="fas fa-map-marker-alt"></i>
                             </button>
                         </div>
                         <button type="submit" class="publish-btn" onclick="showPostSettings(event)">
                             <i class="fas fa-paper-plane"></i>
                             <span>–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</span>
                         </button>
                     </div>
    </form>
            </div>
</div>

        <!-- –≠–º–æ–¥–∑–∏-–ø–∏–∫–µ—Ä -->
        <div id="emoji-picker" class="emoji-picker" style="display: none;">
            <div class="emoji-picker-header">
                <h4>–í—ã–±–µ—Ä–∏—Ç–µ —ç–º–æ–¥–∑–∏</h4>
                <button type="button" class="close-emoji-btn" onclick="closeEmojiPicker()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="emoji-grid">
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòÄ')">üòÄ</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòÉ')">üòÉ</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòÑ')">üòÑ</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòÅ')">üòÅ</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòÜ')">üòÜ</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòÖ')">üòÖ</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòÇ')">üòÇ</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü§£')">ü§£</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòä')">üòä</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòá')">üòá</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üôÇ')">üôÇ</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üôÉ')">üôÉ</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòâ')">üòâ</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòå')">üòå</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòç')">üòç</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü•∞')">ü•∞</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòò')">üòò</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòó')">üòó</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòô')">üòô</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòö')">üòö</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòã')">üòã</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòõ')">üòõ</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòù')">üòù</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòú')">üòú</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü§™')">ü§™</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü§®')">ü§®</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üßê')">üßê</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü§ì')">ü§ì</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòé')">üòé</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü§©')">ü§©</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü•≥')">ü•≥</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòè')">üòè</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòí')">üòí</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòû')">üòû</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòî')">üòî</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòü')">üòü</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòï')">üòï</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üôÅ')">üôÅ</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('‚òπÔ∏è')">‚òπÔ∏è</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üò£')">üò£</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòñ')">üòñ</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üò´')">üò´</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üò©')">üò©</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü•∫')">ü•∫</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üò¢')">üò¢</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üò≠')">üò≠</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üò§')">üò§</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üò†')">üò†</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üò°')">üò°</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü§¨')">ü§¨</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü§Ø')">ü§Ø</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üò≥')">üò≥</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü•µ')">ü•µ</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü•∂')">ü•∂</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üò±')">üò±</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üò®')">üò®</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üò∞')">üò∞</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üò•')">üò•</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòì')">üòì</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü§ó')">ü§ó</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü§î')">ü§î</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü§≠')">ü§≠</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü§´')">ü§´</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü§•')">ü§•</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üò∂')">üò∂</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòê')">üòê</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòë')">üòë</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòØ')">üòØ</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üò¶')">üò¶</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòß')">üòß</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòÆ')">üòÆ</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üò≤')">üò≤</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü•±')">ü•±</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üò¥')">üò¥</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü§§')">ü§§</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üò™')">üò™</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üòµ')">üòµ</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü§ê')">ü§ê</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü•¥')">ü•¥</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü§¢')">ü§¢</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü§Æ')">ü§Æ</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü§ß')">ü§ß</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('üò∑')">üò∑</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü§í')">ü§í</button>
                <button type="button" class="emoji-btn" onclick="selectEmoji('ü§ï')">ü§ï</button>
            </div>
        </div>

        <!-- –ü–æ—Å—Ç—ã -->
{% if posts %}
            <div class="posts-container">
    {% for post in posts %}
                    {% if post.user %}
                    <article class="post-card" data-post-id="{{ post.id }}">
                        {% if post.original_post %}
                        <div class="repost-indicator">
                            <i class="fas fa-share-alt"></i>
                            <em>–≠—Ç–æ—Ç –ø–æ—Å—Ç –ø–µ—Ä–µ—Å–ª–∞–ª–∏. </em>
                            <a href="{{ url_for('profile', username=post.original_post.user.username) }}" class="original-author-link">
                                {{ post.original_post.user.first_name }} {{ post.original_post.user.last_name }}
                            </a>
                        </div>
                        {% endif %}
                        
                        {% if post.post_type == 'community' %}
                        <div class="community-indicator">
                            <i class="fas fa-users"></i>
                            <em>–ü–æ—Å—Ç –∏–∑ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ </em>
                            <a href="{{ url_for('community', community_id=post.community.id) }}" class="community-link">
                                {{ post.community.name }}
                            </a>
                        </div>
                        {% endif %}
                        
        <div class="post-header">
                            <div class="post-user-info">
                                <div class="post-avatar">
                                    {% if post.user and post.user.avatar %}
                                        <img src="{{ url_for('static', filename=post.user.avatar) }}" alt="–ê–≤–∞—Ç–∞—Ä {{ post.user.username }}" style="width:100%;height:100%;object-fit:cover;border-radius:50%;">
                                    {% elif post.user and post.user.username %}
                                        {{ post.user.username[0].upper() }}
                                    {% else %}
                                        ?
                                    {% endif %}
            </div>
                                <div class="user-details">
                                    <h4 class="user-name">
                                        {% if post.user and post.user.username %}
                                            <a href="{{ url_for('profile', username=post.user.username) }}">
                        {{ post.user.first_name }} {{ post.user.last_name }}
                    </a>
                                        {% else %}
                                            <span>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª–µ–Ω</span>
                                        {% endif %}
                </h4>
                                    <div class="post-meta">
                                        {% if post.user and post.user.username %}
                                            <span class="username">@{{ post.user.username }}</span>
                                        {% else %}
                                            <span class="username">@deleted</span>
                                        {% endif %}
                                        <span class="post-time">
                                            <i class="fas fa-clock"></i>
                                            {{ post.created_at.strftime('%d.%m.%Y –≤ %H:%M') }}
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div class="post-menu">
                                <button class="menu-btn" title="–î–µ–π—Å—Ç–≤–∏—è">
                                    <i class="fas fa-ellipsis-h"></i>
                                </button>
            </div>
        </div>
        
        <div class="post-content">
                            <p>{{ post.content }}</p>
                            
                            <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è -->
                            {% if post.image %}
                            <div class="post-image">
                                {% set image_url = url_for('static', filename=post.image) %}
                                <img src="{{ image_url }}" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –ø–æ—Å—Ç–µ" class="post-image-content" 
                                     onerror="console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:', '{{ image_url }}'); this.style.display='none'; this.nextElementSibling.style.display='block';">
                                <div style="display:none; padding:2rem; text-align:center; color:#999; background:#f5f5f5; border-radius:8px;">
                                    <i class="fas fa-exclamation-triangle" style="font-size:2rem; margin-bottom:1rem; opacity:0.5;"></i>
                                    <p style="margin:0;">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ</p>
                                    <p style="font-size:0.75rem; margin-top:0.5rem; opacity:0.7;">–ü—É—Ç—å: {{ post.image }}</p>
                                </div>
                            </div>
                            {% endif %}
                            
                            <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–∏–¥–µ–æ -->
                            {% if post.video %}
                            <div class="post-video">
                                <video controls>
                                    <source src="{{ url_for('static', filename=post.video) }}" type="video/mp4">
                                    –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
                                </video>
                            </div>
                            {% endif %}
                            
                            <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —ç–º–æ–¥–∑–∏ -->
                            {% if post.emoji %}
                            <div class="post-emoji">
                                <span class="emoji-display">{{ post.emoji }}</span>
                            </div>
                            {% endif %}
                            
                            <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ -->
                            {% if post.location %}
                            <div class="post-location">
                                <div class="location-info">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span>{{ post.location_name or post.location }}</span>
                                </div>
                                <div class="location-map" id="map-{{ post.id }}" data-lat="{{ post.location.split(',')[0] }}" data-lng="{{ post.location.split(',')[1] }}"></div>
                            </div>
                            {% endif %}
                            
                            <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–≥–æ–≤ -->
                            {% if post.tags %}
                            <div class="post-tags">
                                {% for tag in post.get_tags_list() %}
                                <span class="tag">{{ tag }}</span>
                                {% endfor %}
                            </div>
                            {% endif %}
                            
                            <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
                            {% if post.category %}
                            <div class="post-category">
                                <span class="category-badge" style="background-color: {{ post.category.color if post.category.color else '#3498db' }}">
                                    <i class="fas fa-tag"></i> {{ post.category }}
                                </span>
                            </div>
                            {% endif %}
                        </div>
                        
                        <div class="post-stats">
                            <div class="stat-item">
                                <i class="fas fa-heart"></i>
                                <span>{{ post.likes_count }}</span>
                            </div>
                            <div class="stat-item">
                                <i class="fas fa-comment"></i>
                                <span>{{ post._comments_list|length }}</span>
                            </div>
                            <div class="stat-item">
                                <i class="fas fa-share"></i>
                                <span>0</span>
                            </div>
        </div>
        
        <div class="post-actions">
                            {% if post.post_type == 'community' %}
                                <button class="action-btn like-btn {% if post.user_liked %}liked{% endif %}" 
                                        data-post-id="{{ post.id }}" onclick="toggleCommunityLike({{ post.id }})">
                                    <i class="{% if post.user_liked %}fas fa-heart{% else %}far fa-heart{% endif %}"></i>
                                    <span>{% if post.user_liked %}–õ–∞–π–∫–Ω—É—Ç–æ{% else %}–õ–∞–π–∫{% endif %}</span>
                                </button>
                            {% else %}
                                <button class="action-btn like-btn {% if post.id in user_liked_posts %}liked{% endif %}" 
                                        data-post-id="{{ post.id }}" onclick="toggleLike({{ post.id }})">
                                    <i class="{% if post.id in user_liked_posts %}fas fa-heart{% else %}far fa-heart{% endif %}"></i>
                                    <span>–õ–∞–π–∫</span>
                                </button>
                            {% endif %}
                            
                            <button class="action-btn comment-btn" onclick="toggleComments({{ post.id }})">
                                <i class="fas fa-comment"></i>
                                <span>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</span>
                            </button>
                            
                            <button class="action-btn share-btn" onclick="sharePost({{ post.id }})">
                                <i class="fas fa-share-alt"></i>
                                <span>–ü–æ–¥–µ–ª–∏—Ç—å—Å—è</span>
                            </button>
                        </div>
                        
                        
                        
                        <!-- –°–µ–∫—Ü–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ -->
                        <div class="comments-section" id="comments-{{ post.id }}" style="display: none;">
                            <div class="comments-header">
                                <h4>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ({{ post._comments_list|length }})</h4>
                            </div>
                            
                            <!-- –§–æ—Ä–º–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è -->
                            {% if post.post_type == 'community' %}
                            <form class="comment-form" onsubmit="addCommunityComment(event, {{ post.id }})">
                                <div class="comment-input-wrapper">
                                    <input type="text" name="content" class="comment-input" placeholder="–ù–∞–ø–∏—Å–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..." required>
                                    <button type="submit" class="comment-submit">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </div>
                            </form>
                            {% else %}
                            <form method="POST" action="{{ url_for('create_comment', post_id=post.id) }}" class="comment-form">
                                <div class="comment-input-wrapper">
                                    <input type="text" name="content" class="comment-input" placeholder="–ù–∞–ø–∏—Å–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..." required>
                                    <button type="submit" class="comment-submit">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </div>
                            </form>
                            {% endif %}
                            
                            <!-- –°–ø–∏—Å–æ–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ -->
                            <div class="comments-list">
                                {% for comment in post._comments_list %}
                                <div class="comment-item">
                                    <div class="comment-avatar">
                                        {% if post.post_type == 'community' %}
                                            {{ comment.user.username[0].upper() if comment.user else 'U' }}
                                        {% else %}
                                            {{ comment.user.username[0].upper() }}
                                        {% endif %}
                                    </div>
                                    <div class="comment-content">
                                        <div class="comment-header">
                                            <span class="comment-author">
                                                {% if post.post_type == 'community' %}
                                                    {{ comment.user.username if comment.user else 'Unknown' }}
                                                {% else %}
                                                    {{ comment.user.username }}
                                                {% endif %}
                                            </span>
                                            <span class="comment-time">{{ comment.created_at.strftime('%d.%m.%Y %H:%M') }}</span>
                                        </div>
                                        <p class="comment-text">{{ comment.content }}</p>
                                        
                                        {% if comment.user_id == session.user_id %}
                                        <div class="comment-actions">
                                            {% if post.post_type == 'community' %}
                                            <button class="comment-action-btn" onclick="deleteCommunityComment({{ comment.id }})">
                                                <i class="fas fa-trash"></i>
                                                <span>–£–¥–∞–ª–∏—Ç—å</span>
                                            </button>
                                            {% else %}
                                            <button class="comment-action-btn" onclick="deleteComment({{ comment.id }})">
                                                <i class="fas fa-trash"></i>
                                                <span>–£–¥–∞–ª–∏—Ç—å</span>
                                            </button>
                                            {% endif %}
                                        </div>
                                        {% endif %}
        </div>
    </div>
    {% endfor %}
                            </div>
                        </div>
                    </article>

                    {% if loop.index % 3 == 0 and suggested_users %}
                    <section class="suggestions-card">
                        <div class="suggestions-header">
                            <h4><i class="fas fa-user-friends"></i> –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏</h4>
                        </div>
                        <div class="suggestions-grid">
                            {% for u in suggested_users %}
                            <div class="suggestion-item">
                                <a href="{{ url_for('profile', username=u.username) }}" class="suggest-user">
                                    <div class="suggest-avatar">
                                        {% if u.avatar %}
                                            <img src="{{ url_for('static', filename=u.avatar) }}" alt="{{ u.username }}">
                                        {% else %}
                                            {{ u.username[0].upper() }}
                                        {% endif %}
                                    </div>
                                    <div class="suggest-info">
                                        <div class="suggest-name">{{ u.first_name }} {{ u.last_name }}</div>
                                        <div class="suggest-username">@{{ u.username }}</div>
                                    </div>
                                </a>
                                <a class="follow-btn" href="{{ url_for('follow_user', username=u.username) }}">
                                    <i class="fas fa-user-plus"></i> –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è
                                </a>
                            </div>
                            {% endfor %}
                        </div>
                    </section>
                    {% endif %}
                    {% endif %}
                {% endfor %}
            </div>
{% else %}
            <div class="empty-state">
                <div class="empty-icon">
                    <i class="fas fa-newspaper"></i>
                </div>
                <h3>–ü–æ–∫–∞ –Ω–µ—Ç –ø–æ—Å—Ç–æ–≤</h3>
                <p>–ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º, –∫—Ç–æ –ø–æ–¥–µ–ª–∏—Ç—Å—è —á–µ–º-—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º!</p>
                <div class="empty-actions">
                    <button class="btn btn-primary" onclick="document.querySelector('.post-textarea').focus()">
                        <i class="fas fa-plus"></i>
                        –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π –ø–æ—Å—Ç
                    </button>
                </div>
    </div>
{% endif %}
    </div>
    
</div>

<script>
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
    function toggleComments(postId) {
        const commentsSection = document.getElementById(`comments-${postId}`);
        const isVisible = commentsSection.style.display !== 'none';
        
        if (isVisible) {
            commentsSection.style.display = 'none';
        } else {
            commentsSection.style.display = 'block';
        }
    }
    
    // –õ–∞–π–∫ –ø–æ—Å—Ç–∞
    function toggleLike(postId) {
        const likeBtn = document.querySelector(`[data-post-id="${postId}"].like-btn`);
        const likeIcon = likeBtn.querySelector('i');
        const likeText = likeBtn.querySelector('span');
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        fetch(`/like_post/${postId}`, {
            method: 'POST'
        })
        .then(response => {
            if (response.status === 429) {
                // –û—à–∏–±–∫–∞ –∫—É–ª–¥–∞—É–Ω–∞
                return response.json().then(data => {
                    throw new Error(data.error || '–°–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ –ª–∞–π–∫–∞–µ—Ç–µ');
                });
            }
            return response.json();
        })
        .then(data => {
            if (data.success) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥ –∫–Ω–æ–ø–∫–∏
                if (data.liked) {
                    likeBtn.classList.add('liked');
                    likeIcon.className = 'fas fa-heart';
                    likeText.textContent = '–õ–∞–π–∫–Ω—É—Ç–æ';
                } else {
                    likeBtn.classList.remove('liked');
                    likeIcon.className = 'far fa-heart';
                    likeText.textContent = '–õ–∞–π–∫';
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –ª–∞–π–∫–æ–≤
                const likeCount = document.querySelector(`#like-count-${postId}`);
                if (likeCount) {
                    likeCount.textContent = data.likes_count;
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
                showLikeNotification(data.liked ? '–õ–∞–π–∫ –¥–æ–±–∞–≤–ª–µ–Ω!' : '–õ–∞–π–∫ —É–±—Ä–∞–Ω!', 'success');
            } else {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ª–∞–π–∫–µ:', data.error);
                showLikeNotification(data.error || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ª–∞–π–∫–µ', 'error');
            }
        })
        .catch(error => {
            console.error('–û—à–∏–±–∫–∞:', error);
            showLikeNotification(error.message || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ª–∞–π–∫–µ', 'error');
        });
    }
    
    // –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –ª–∞–π–∫–∞—Ö
    function showLikeNotification(message, type) {
        // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        const notification = document.createElement('div');
        notification.className = `like-notification ${type}`;
        notification.textContent = message;
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏
        notification.style.cssText = `
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            z-index: 10000;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
            max-width: 300px;
            word-wrap: break-word;
        `;
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–≤–µ—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
        if (type === 'success') {
            notification.style.background = 'linear-gradient(45deg, #27ae60, #2ecc71)';
        } else if (type === 'error') {
            notification.style.background = 'linear-gradient(45deg, #e74c3c, #c0392b)';
        } else if (type === 'info') {
            notification.style.background = 'linear-gradient(45deg, #3498db, #2980b9)';
        }
        
        // –î–æ–±–∞–≤–ª—è–µ–º –≤ DOM
        document.body.appendChild(notification);
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        setTimeout(() => {
            notification.style.transform = 'translateX(0)';
        }, 100);
        
        // –°–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
        setTimeout(() => {
            notification.style.transform = 'translateX(-100%)';
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 300);
        }, 3000);
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ª–∞–π–∫–æ–≤ –ø–æ—Å—Ç–æ–≤ —Å–æ–æ–±—â–µ—Å—Ç–≤
    function toggleCommunityLike(postId) {
        const likeBtn = document.querySelector(`[data-post-id="${postId}"].like-btn`);
        const likeIcon = likeBtn.querySelector('i');
        const likeText = likeBtn.querySelector('span');
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        fetch(`/like_community_post/${postId}`, {
            method: 'POST'
        })
        .then(response => {
            if (response.status === 429) {
                // –û—à–∏–±–∫–∞ –∫—É–ª–¥–∞—É–Ω–∞
                return response.json().then(data => {
                    throw new Error(data.error || '–°–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ –ª–∞–π–∫–∞–µ—Ç–µ');
                });
            }
            return response.json();
        })
        .then(data => {
            if (data.success) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥ –∫–Ω–æ–ø–∫–∏
                if (data.liked) {
                    likeBtn.classList.add('liked');
                    likeIcon.className = 'fas fa-heart';
                    likeText.textContent = '–õ–∞–π–∫–Ω—É—Ç–æ';
                } else {
                    likeBtn.classList.remove('liked');
                    likeIcon.className = 'far fa-heart';
                    likeText.textContent = '–õ–∞–π–∫';
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –ª–∞–π–∫–æ–≤ –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ –ø–æ—Å—Ç–∞
                const postCard = likeBtn.closest('.post-card');
                if (postCard) {
                    const likeCount = postCard.querySelector('.post-stats .stat-item:first-child span');
                    if (likeCount) {
                        likeCount.textContent = data.likes_count;
                    }
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
                showLikeNotification(data.liked ? '–õ–∞–π–∫ –¥–æ–±–∞–≤–ª–µ–Ω!' : '–õ–∞–π–∫ —É–±—Ä–∞–Ω!', 'success');
            } else {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ª–∞–π–∫–µ:', data.error);
                showLikeNotification(data.error || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ª–∞–π–∫–µ', 'error');
            }
        })
        .catch(error => {
            console.error('–û—à–∏–±–∫–∞:', error);
            showLikeNotification(error.message || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ª–∞–π–∫–µ', 'error');
        });
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∫ –ø–æ—Å—Ç–∞–º —Å–æ–æ–±—â–µ—Å—Ç–≤
    function addCommunityComment(event, postId) {
        event.preventDefault();
        
        const form = event.target;
        const content = form.querySelector('input[name="content"]').value.trim();
        
        if (!content) return;
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        fetch(`/add_community_comment/${postId}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ content: content })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
                form.querySelector('input[name="content"]').value = '';
                
                // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
                window.location.reload();
            } else {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è:', data.error);
            }
        })
        .catch(error => {
            console.error('–û—à–∏–±–∫–∞:', error);
        });
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∫ –ø–æ—Å—Ç–∞–º —Å–æ–æ–±—â–µ—Å—Ç–≤
    function deleteCommunityComment(commentId) {
        if (confirm('–£–¥–∞–ª–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π?')) {
            fetch(`/delete_community_comment/${commentId}`, {
                method: 'POST'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
                    window.location.reload();
                } else {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è:', data.error);
                }
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞:', error);
            });
        }
    }
    
    // –®–∞—Ä–∏–Ω–≥ –ø–æ—Å—Ç–∞
    function sharePost(postId) {
        window.location.href = `/share/${postId}`;
    }
    
    // –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
    function deleteComment(commentId) {
        if (confirm('–£–¥–∞–ª–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π?')) {
            window.location.href = `/delete_comment/${commentId}`;
        }
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ AJAX
    function updatePostStats() {
        const posts = document.querySelectorAll('.post-card');
        
        posts.forEach(post => {
            const postId = post.dataset.postId;
            const likeCount = post.querySelector('.like-btn');
            const commentCount = post.querySelector('.comment-btn');
            
            fetch(`/api/post/${postId}/stats`)
                .then(response => response.json())
                .then(data => {
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏ –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ
                    const stats = post.querySelectorAll('.stat-item span');
                    if (stats[0]) stats[0].textContent = data.likes_count;
                    if (stats[1]) stats[1].textContent = data.comments_count;
                })
                .catch(error => console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error));
        });
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
    setInterval(updatePostStats, 10000);
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    document.addEventListener('DOMContentLoaded', function() {
        updatePostStats();
        

        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É —Ä–µ–∫–ª–∞–º—ã –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º fallback
        setTimeout(checkAdLoading, 3000);
        
        // –§–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞
        const textarea = document.querySelector('.post-textarea');
        if (textarea) {
            textarea.addEventListener('focus', function() {
                this.parentElement.classList.add('focused');
            });
            
            textarea.addEventListener('blur', function() {
                this.parentElement.classList.remove('focused');
            });
        }
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ä–µ–∞–∫—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö –ø–æ—Å—Ç–æ–≤
        document.querySelectorAll('.post-card').forEach(postCard => {
            const postId = postCard.dataset.postId;
            if (postId) {
                loadReactions(postId);
            }
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∞–≤–∏—à–∏ Escape –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è popup
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const popup = document.getElementById('post-settings-popup');
                if (popup && popup.style.display !== 'none') {
                    closePostSettings();
                }
            }
        });
    });
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–∫–ª–∞–º—ã
    function checkAdLoading() {
        const adBlocks = document.querySelectorAll('.adsbygoogle');
        const fallbacks = document.querySelectorAll('.ad-fallback');
        
        adBlocks.forEach((ad, index) => {
            if (ad.offsetHeight === 0 || ad.innerHTML.trim() === '') {
                // –†–µ–∫–ª–∞–º–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º fallback
                if (fallbacks[index]) {
                    fallbacks[index].style.display = 'block';
                }
            }
        });
    }
    
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    function addImage() {
        document.getElementById('image-input').click();
    }
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    document.getElementById('image-input').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('preview-img').src = e.target.result;
                document.getElementById('image-preview').style.display = 'block';
            };
            reader.readAsDataURL(file);
        }
    });
    
    // –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    function removeImage() {
        document.getElementById('image-input').value = '';
        document.getElementById('image-preview').style.display = 'none';
        document.getElementById('preview-img').src = '';
    }
    
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–µ–æ
    function addVideo() {
        document.getElementById('video-input').click();
    }
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –≤–∏–¥–µ–æ
    document.getElementById('video-input').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('preview-video').src = e.target.result;
                document.getElementById('video-source').src = e.target.result;
                document.getElementById('video-preview').style.display = 'block';
            };
            reader.readAsDataURL(file);
        }
    });
    
    // –£–¥–∞–ª–µ–Ω–∏–µ –≤–∏–¥–µ–æ
    function removeVideo() {
        document.getElementById('video-input').value = '';
        document.getElementById('video-preview').style.display = 'none';
        document.getElementById('preview-video').src = '';
        document.getElementById('video-source').src = '';
    }
    
    // –ü–æ–∫–∞–∑–∞—Ç—å —ç–º–æ–¥–∑–∏-–ø–∏–∫–µ—Ä
    function showEmojiPicker() {
        const emojiPicker = document.getElementById('emoji-picker');
        if (emojiPicker) {
            emojiPicker.style.display = 'block';
        }
    }
    
    // –í—ã–±–æ—Ä —ç–º–æ–¥–∑–∏
    function selectEmoji(emoji) {
        document.getElementById('emoji-field').value = emoji;
        document.getElementById('selected-emoji').textContent = emoji;
        document.getElementById('emoji-preview').style.display = 'block';
        document.getElementById('emoji-picker').style.display = 'none';
    }
    
    // –ó–∞–∫—Ä—ã—Ç—å —ç–º–æ–¥–∑–∏-–ø–∏–∫–µ—Ä
    function closeEmojiPicker() {
        document.getElementById('emoji-picker').style.display = 'none';
    }
    
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏
    function addLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
                function(position) {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    
                    // –ü–æ–ª—É—á–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Å—Ç–∞ —á–µ—Ä–µ–∑ –æ–±—Ä–∞—Ç–Ω–æ–µ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
                    fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}`)
                        .then(response => response.json())
                        .then(data => {
                            const locationName = data.display_name.split(',')[0];
                            
                            document.getElementById('location-field').value = `${lat},${lng}`;
                            document.getElementById('location-name-field').value = locationName;
                            document.getElementById('selected-location').textContent = locationName;
                            document.getElementById('location-preview').style.display = 'block';
                        })
                        .catch(() => {
                            // –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
                            document.getElementById('location-field').value = `${lat},${lng}`;
                            document.getElementById('location-name-field').value = `${lat.toFixed(4)}, ${lng.toFixed(4)}`;
                            document.getElementById('selected-location').textContent = `${lat.toFixed(4)}, ${lng.toFixed(4)}`;
                            document.getElementById('location-preview').style.display = 'block';
                        });
                },
                function(error) {
                    alert('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –≤–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–∞.');
                }
            );
        } else {
            alert('–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ.');
        }
    }
    
    // –£–¥–∞–ª–µ–Ω–∏–µ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏
    function removeLocation() {
        document.getElementById('location-field').value = '';
        document.getElementById('location-name-field').value = '';
        document.getElementById('location-preview').style.display = 'none';
    }
    
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∞–∫—Ü–∏–∏
    function addReaction(postId, reactionType) {
        fetch(`/reaction/${postId}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ reaction_type: reactionType })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                updateReactionUI(postId, reactionType, data.reaction_removed);
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏ —Ä–µ–∞–∫—Ü–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
                updateReactionCounts(postId, reactionType, data.reaction_removed);
            }
        })
        .catch(error => {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ä–µ–∞–∫—Ü–∏–∏:', error);
        });
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–æ–≤ —Ä–µ–∞–∫—Ü–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
    function updateReactionCounts(postId, reactionType, removed) {
        if (removed) {
            // –ï—Å–ª–∏ —Ä–µ–∞–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∞, —É–º–µ–Ω—å—à–∞–µ–º —Å—á–µ—Ç—á–∏–∫
            const countElement = document.getElementById(`${reactionType}-count-${postId}`);
            if (countElement) {
                let currentCount = parseInt(countElement.textContent) || 0;
                currentCount = Math.max(0, currentCount - 1);
                countElement.textContent = currentCount;
            }
            showReactionNotification('–†–µ–∞–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∞', 'info');
        } else {
            // –ï—Å–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è —Ä–µ–∞–∫—Ü–∏—è, –Ω—É–∂–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å—á–µ—Ç—á–∏–∫–∏
            // –∏ —É–≤–µ–ª–∏—á–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–π
            const allReactionTypes = ['like', 'laugh', 'surprise', 'sad', 'love', 'angry'];
            
            allReactionTypes.forEach(type => {
                const countElement = document.getElementById(`${type}-count-${postId}`);
                if (countElement) {
                    if (type === reactionType) {
                        // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –¥–ª—è –Ω–æ–≤–æ–π —Ä–µ–∞–∫—Ü–∏–∏
                        let currentCount = parseInt(countElement.textContent) || 0;
                        currentCount += 1;
                        countElement.textContent = currentCount;
                    } else {
                        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫–∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ä–µ–∞–∫—Ü–∏–π (–µ—Å–ª–∏ –æ–Ω–∏ –±—ã–ª–∏)
                        const wasActive = document.querySelector(`button[data-reaction="${type}"][onclick*="${postId}"]`).classList.contains('active');
                        if (wasActive) {
                            let currentCount = parseInt(countElement.textContent) || 0;
                            currentCount = Math.max(0, currentCount - 1);
                            countElement.textContent = currentCount;
                        }
                    }
                }
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤–æ–π —Ä–µ–∞–∫—Ü–∏–∏
            const reactionNames = {
                'like': '‚ù§Ô∏è –õ–∞–π–∫',
                'laugh': 'üòÑ –°–º–µ—Ö',
                'surprise': 'üò≤ –£–¥–∏–≤–ª–µ–Ω–∏–µ',
                'sad': 'üò¢ –ì—Ä—É—Å—Ç—å',
                'love': 'üíï –õ—é–±–æ–≤—å',
                'angry': 'üò† –ó–ª–æ—Å—Ç—å'
            };
            showReactionNotification(`–î–æ–±–∞–≤–ª–µ–Ω–∞ —Ä–µ–∞–∫—Ü–∏—è: ${reactionNames[reactionType] || reactionType}`, 'success');
        }
    }
    
    // –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ —Ä–µ–∞–∫—Ü–∏—è—Ö
    function showReactionNotification(message, type) {
        // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        const notification = document.createElement('div');
        notification.className = `reaction-notification ${type}`;
        notification.textContent = message;
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏
        notification.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            z-index: 10000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            max-width: 300px;
            word-wrap: break-word;
        `;
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–≤–µ—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
        if (type === 'success') {
            notification.style.background = 'linear-gradient(45deg, #27ae60, #2ecc71)';
        } else if (type === 'info') {
            notification.style.background = 'linear-gradient(45deg, #3498db, #2980b9)';
        }
        
        // –î–æ–±–∞–≤–ª—è–µ–º –≤ DOM
        document.body.appendChild(notification);
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        setTimeout(() => {
            notification.style.transform = 'translateX(0)';
        }, 100);
        
        // –°–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
        setTimeout(() => {
            notification.style.transform = 'translateX(100%)';
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 300);
        }, 3000);
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI —Ä–µ–∞–∫—Ü–∏–π
    function updateReactionUI(postId, reactionType, removed) {
        // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —É –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ —Ä–µ–∞–∫—Ü–∏–π –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ—Å—Ç–∞
        document.querySelectorAll(`button[data-reaction][onclick*="${postId}"]`).forEach(btn => {
            btn.classList.remove('active');
        });
        
        if (!removed) {
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ä–µ–∞–∫—Ü–∏–∏
            const reactionBtn = document.querySelector(`button[data-reaction="${reactionType}"][onclick*="${postId}"]`);
            if (reactionBtn) {
                reactionBtn.classList.add('active');
            }
        }
    }
    
    // –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∞–∫—Ü–∏–π –¥–ª—è –ø–æ—Å—Ç–∞
    function loadReactions(postId) {
        fetch(`/api/post/${postId}/reactions`)
        .then(response => response.json())
        .then(data => {
            if (data.reaction_counts) {
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏ —Ä–µ–∞–∫—Ü–∏–π
                Object.keys(data.reaction_counts).forEach(reactionType => {
                    const countElement = document.getElementById(`${reactionType}-count-${postId}`);
                    if (countElement) {
                        countElement.textContent = data.reaction_counts[reactionType];
                    }
                });
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é —Ä–µ–∞–∫—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                if (data.user_reaction) {
                    document.querySelectorAll(`button[data-reaction][onclick*="${postId}"]`).forEach(btn => {
                        btn.classList.remove('active');
                    });
                    const activeBtn = document.querySelector(`button[data-reaction="${data.user_reaction}"][onclick*="${postId}"]`);
                    if (activeBtn) {
                        activeBtn.classList.add('active');
                    }
                }
            }
        });
    }
    
    // –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∞–∫—Ü–∏–π –¥–ª—è –≤—Å–µ—Ö –ø–æ—Å—Ç–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    function loadAllReactions() {
        const posts = document.querySelectorAll('.post-card');
        posts.forEach(post => {
            const postId = post.querySelector('.action-btn').getAttribute('data-post-id');
            if (postId) {
                loadReactions(postId);
            }
        });
    }
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ä–µ–∞–∫—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    document.addEventListener('DOMContentLoaded', function() {
        loadAllReactions();
        
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫—É–ª–¥–∞—É–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        resetUserCooldown();
    });
    
    // –°–±—Ä–æ—Å –∫—É–ª–¥–∞—É–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    function resetUserCooldown() {
        fetch('/api/reset-cooldown', {
            method: 'POST'
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                console.log('–ö—É–ª–¥–∞—É–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–±—Ä–æ—à–µ–Ω');
            }
        })
        .catch(error => {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±—Ä–æ—Å–µ –∫—É–ª–¥–∞—É–Ω–∞:', error);
        });
    }
    
    // –ü–æ–∫–∞–∑–∞—Ç—å popup —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ—Å—Ç–∞
    function showPostSettings(event) {
        event.preventDefault();
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –µ—Å—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –ø–æ—Å—Ç–∞
        const content = document.getElementById('emoji-field').value || 
                       document.getElementById('image-input').files[0] || 
                       document.getElementById('video-input').files[0] ||
                       document.querySelector('.post-textarea').value.trim();
        
        if (!content) {
            alert('–î–æ–±–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –≤–∏–¥–µ–æ –∏–ª–∏ —ç–º–æ–¥–∑–∏ –∫ –ø–æ—Å—Ç—É');
            return;
        }
        
        // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –º–µ–∂–¥—É —Å–∫—Ä—ã—Ç—ã–º–∏ –ø–æ–ª—è–º–∏ –∏ popup
        document.getElementById('popup-visibility').value = document.getElementById('visibility').value;
        document.getElementById('popup-category').value = document.getElementById('category').value;
        document.getElementById('popup-tags').value = document.getElementById('tags').value;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º popup
        document.getElementById('post-settings-popup').style.display = 'block';
        document.body.style.overflow = 'hidden'; // –ë–ª–æ–∫–∏—Ä—É–µ–º —Å–∫—Ä–æ–ª–ª
    }
    
    // –ó–∞–∫—Ä—ã—Ç—å popup —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ—Å—Ç–∞
    function closePostSettings() {
        document.getElementById('post-settings-popup').style.display = 'none';
        document.body.style.overflow = ''; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–∫—Ä–æ–ª–ª
    }
    
    // –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –ø–æ—Å—Ç —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
    function publishPost() {
        // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ popup –≤ —Å–∫—Ä—ã—Ç—ã–µ –ø–æ–ª—è
        document.getElementById('visibility').value = document.getElementById('popup-visibility').value;
        document.getElementById('category').value = document.getElementById('popup-category').value;
        document.getElementById('tags').value = document.getElementById('popup-tags').value;
        
        // –ó–∞–∫—Ä—ã–≤–∞–µ–º popup
        closePostSettings();
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ñ–æ—Ä–º—É
        document.querySelector('.create-post-form').submit();
    }
    

    

</script>

<style>
    /* –û—Å–Ω–æ–≤–Ω–æ–π –º–∞–∫–µ—Ç */
    .feed-layout {
        display: grid;
        grid-template-columns: 1fr 300px;
        gap: 2rem;
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 1rem;
    }
    
    /* –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ —Å –ø–æ—Å—Ç–∞–º–∏ */
    .posts-column {
        min-width: 0; /* –î–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è grid */
    }
    
    /* –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ —Å —Ä–µ–∫–ª–∞–º–æ–π */
    .ads-column {
        position: relative;
    }
    
    .sticky-ads {
        position: sticky;
        top: 2rem;
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
        max-height: calc(100vh - 4rem);
        overflow-y: auto;
        padding-right: 0.5rem;
    }
    
    /* –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ –¥–ª—è sticky-ads */
    .sticky-ads::-webkit-scrollbar {
        width: 6px;
    }
    
    .sticky-ads::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 3px;
    }
    
    .sticky-ads::-webkit-scrollbar-thumb {
        background: rgba(52, 152, 219, 0.5);
        border-radius: 3px;
    }
    
    .sticky-ads::-webkit-scrollbar-thumb:hover {
        background: rgba(52, 152, 219, 0.7);
    }
    
    /* –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ –¥–ª—è Firefox */
    .sticky-ads {
        scrollbar-width: thin;
        scrollbar-color: rgba(52, 152, 219, 0.5) rgba(255, 255, 255, 0.05);
    }
    
    /* –†–µ–∫–ª–∞–º–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ */
    .ad-card {
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 8px;
        padding: 1rem;
        transition: all 0.3s ease;
        overflow: hidden;
    }
    
    .ad-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }
    
    .ad-header {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin-bottom: 1rem;
        font-size: 0.9rem;
        color: #007AFF;
        font-weight: 600;
    }
    
    .ad-content {
        min-height: 100px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    /* Google AdSense –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
    .adsbygoogle {
        display: block;
        text-align: center;
        margin: 0 auto;
    }
    
    /* Fallback —Ç–µ–∫—Å—Ç –∫–æ–≥–¥–∞ —Ä–µ–∫–ª–∞–º–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å */
    .ad-fallback {
        text-align: center;
        padding: 1rem;
        color: rgba(26, 26, 26, 0.8);
    }
    
    .ad-fallback h4 {
        color: #007AFF;
        margin: 0 0 0.75rem 0;
        font-size: 1.1rem;
        font-weight: 600;
    }
    
    .ad-fallback p {
        margin: 0;
        font-size: 0.9rem;
        line-height: 1.4;
        color: rgba(255, 255, 255, 0.7);
    }
    
    /* –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞ –º–µ–∂–¥—É –ø–æ—Å—Ç–∞–º–∏ */
    .inline-ad {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 16px;
        padding: 1.5rem;
        margin: 1.5rem 0;
        backdrop-filter: blur(10px);
        transition: all 0.3s ease;
        overflow: hidden;
    }
    
    .inline-ad:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }
    
    .inline-ad .ad-header {
        color: #e74c3c;
        margin-bottom: 1rem;
    }
    
    .inline-ad .ad-content {
        min-height: 90px;
    }
    
    /* –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ */
    .create-post-section {
        margin-bottom: 2rem;
    }
    
    .create-post-card {
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 8px;
        padding: 2rem;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
    }
    
    .create-post-header {
        display: flex;
        align-items: center;
        gap: 1.5rem;
        margin-bottom: 1.5rem;
    }
    
    .user-avatar-large {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: linear-gradient(45deg, #007AFF, #66A3FF);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        color: white;
        font-size: 1.5rem;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
    }
    
    .create-post-info h3 {
        color: #1A1A1A;
        margin: 0 0 0.5rem 0;
        font-size: 1.4rem;
        font-weight: 600;
    }
    
    .create-post-info p {
        color: rgba(26, 26, 26, 0.7);
        margin: 0;
        font-size: 1rem;
    }
    
    .create-post-form {
        position: relative;
    }
    
    .post-textarea {
        width: 100%;
        min-height: 120px;
        padding: 1.5rem;
        border: 1px solid rgba(0, 0, 0, 0.12);
        border-radius: 8px;
        background: #ffffff;
        color: #1A1A1A;
        font-size: 1.1rem;
        font-family: inherit;
        resize: vertical;
        transition: all 0.3s ease;
    }
    
    .post-textarea:focus {
        outline: none;
        border-color: #007AFF;
        background: #ffffff;
        box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.12);
    }
    
    .post-textarea::placeholder {
        color: rgba(26, 26, 26, 0.5);
    }
    
    /* –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –º–µ–¥–∏–∞ */
    .image-preview, .emoji-preview, .location-preview {
        margin-top: 1rem;
        padding: 1rem;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        position: relative;
        display: flex;
        align-items: center;
        gap: 1rem;
    }
    
    .image-preview img {
        max-width: 100px;
        max-height: 100px;
        border-radius: 8px;
        object-fit: cover;
    }
    
    .emoji-preview span {
        font-size: 2rem;
    }
    
    .location-preview i {
        color: #e74c3c;
        font-size: 1.2rem;
    }
    
    .location-preview span {
        color: rgba(255, 255, 255, 0.9);
        font-size: 0.9rem;
    }
    
    .remove-image-btn, .remove-emoji-btn, .remove-location-btn {
        background: rgba(231, 76, 60, 0.2);
        border: none;
        color: #e74c3c;
        padding: 0.5rem;
        border-radius: 50%;
        cursor: pointer;
        transition: all 0.3s ease;
        position: absolute;
        top: 0.5rem;
        right: 0.5rem;
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.8rem;
    }
    
    .remove-image-btn:hover, .remove-emoji-btn:hover, .remove-location-btn:hover {
        background: rgba(231, 76, 60, 0.4);
        transform: scale(1.1);
    }
    
    .form-actions {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1.5rem;
    }
    
    .post-options {
        display: flex;
        gap: 0.5rem;
    }
    
    .option-btn {
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.08);
        color: rgba(26, 26, 26, 0.85);
        padding: 0.6rem 0.75rem;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.2s ease;
        font-size: 0.95rem;
    }
    
    .option-btn:hover {
        background: rgba(0, 122, 255, 0.06);
        border-color: rgba(0, 122, 255, 0.25);
        color: #1A1A1A;
        transform: translateY(-2px);
    }
    
    .publish-btn {
        background: #007AFF;
        border: none;
        color: white!important;
        padding: 0.9rem 1.6rem;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 0.75rem;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }
    
    .publish-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        background: #005FCC;
    }
    
    /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Å—Ç–∞ */
    .post-settings {
        margin: 1rem 0;
        padding: 1rem;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 12px;
        border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .setting-group {
        margin-bottom: 1rem;
    }
    
    .setting-group:last-child {
        margin-bottom: 0;
    }
    
    .setting-group label {
        display: block;
        color: rgba(255, 255, 255, 0.8);
        font-size: 0.9rem;
        margin-bottom: 0.5rem;
        font-weight: 500;
    }
    
    .post-select, .post-input {
        width: 100%;
        padding: 0.75rem;
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 8px;
        background: rgba(255, 255, 255, 0.05);
        color: #ffffff;
        font-size: 0.9rem;
        transition: all 0.3s ease;
    }
    
    .post-select:focus, .post-input:focus {
        outline: none;
        border-color: #3498db;
        background: rgba(255, 255, 255, 0.08);
    }
    
    .post-select option {
        background: #2c3e50;
        color: #ffffff;
    }
    
    /* –≠–º–æ–¥–∑–∏-–ø–∏–∫–µ—Ä */
    .emoji-picker {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: #2c3e50;
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 16px;
        padding: 1.5rem;
        z-index: 1000;
        max-width: 500px;
        max-height: 400px;
        overflow-y: auto;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    }
    
    .emoji-picker-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .emoji-picker-header h4 {
        color: #ffffff;
        margin: 0;
        font-size: 1.2rem;
    }
    
    .close-emoji-btn {
        background: none;
        border: none;
        color: rgba(255, 255, 255, 0.6);
        padding: 0.5rem;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .close-emoji-btn:hover {
        background: rgba(255, 255, 255, 0.1);
        color: #ffffff;
    }
    
    .emoji-grid {
        display: grid;
        grid-template-columns: repeat(8, 1fr);
        gap: 0.5rem;
    }
    
    .emoji-btn {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        color: #ffffff;
        padding: 0.75rem;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 1.2rem;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .emoji-btn:hover {
        background: rgba(255, 255, 255, 0.15);
        transform: scale(1.1);
    }
    
    /* –í–∏–¥–µ–æ –≤ –ø–æ—Å—Ç–∞—Ö */
    .post-video {
        margin: 1rem 0;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }
    
    .post-video video {
        width: 100%;
        max-height: 400px;
        object-fit: cover;
        display: block;
    }
    
    /* –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –≤–∏–¥–µ–æ */
    .video-preview {
        position: relative;
        margin: 1rem 0;
        border-radius: 12px;
        overflow: hidden;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .video-preview video {
        width: 100%;
        max-height: 300px;
        object-fit: cover;
        display: block;
    }
    
    .remove-video-btn {
        position: absolute;
        top: 0.5rem;
        right: 0.5rem;
        background: rgba(231, 76, 60, 0.8);
        border: none;
        color: white;
        padding: 0.5rem;
        border-radius: 50%;
        cursor: pointer;
        transition: all 0.3s ease;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.9rem;
    }
    
    .remove-video-btn:hover {
        background: rgba(231, 76, 60, 1);
        transform: scale(1.1);
    }
    
    /* –¢–µ–≥–∏ –≤ –ø–æ—Å—Ç–∞—Ö */
    .post-tags {
        margin: 1rem 0;
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
    }
    
    .tag {
        background: rgba(52, 152, 219, 0.2);
        color: #3498db;
        padding: 0.25rem 0.75rem;
        border-radius: 20px;
        font-size: 0.8rem;
        border: 1px solid rgba(52, 152, 219, 0.3);
        transition: all 0.3s ease;
    }
    
    .tag:hover {
        background: rgba(52, 152, 219, 0.3);
        transform: translateY(-1px);
    }
    
    /* –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ –ø–æ—Å—Ç–∞—Ö */
    .post-category {
        margin: 1rem 0;
    }
    
    .category-badge {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-size: 0.9rem;
        font-weight: 500;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }
    
    /* –†–µ–∞–∫—Ü–∏–∏ */
    .reactions-container {
        display: flex;
        gap: 0.5rem;
        margin: 1rem 0;
        flex-wrap: wrap;
    }
    
    .reaction-btn {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        color: rgba(255, 255, 255, 0.7);
        padding: 0.5rem 1rem;
        border-radius: 20px;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.9rem;
    }
    
    .reaction-btn:hover {
        background: rgba(255, 255, 255, 0.1);
        color: #ffffff;
        transform: translateY(-2px);
    }
    
    .reaction-btn.active {
        background: rgba(52, 152, 219, 0.2);
        border-color: #3498db;
        color: #3498db;
        transform: scale(1.05);
        box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
    }
    
    .reaction-btn.active:hover {
        background: rgba(52, 152, 219, 0.3);
        transform: scale(1.1);
        box-shadow: 0 6px 16px rgba(52, 152, 219, 0.4);
    }
    
    /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ª–∞–π–∫–∞—Ö */
    .like-notification {
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        border: 2px solid rgba(255, 255, 255, 0.1);
    }
    
    .like-notification.success {
        border-color: rgba(39, 174, 96, 0.3);
    }
    
    .like-notification.error {
        border-color: rgba(231, 76, 60, 0.3);
    }
    
    .like-notification.info {
        border-color: rgba(52, 152, 219, 0.3);
    }
    
    .reaction-count {
        background: rgba(255, 255, 255, 0.1);
        color: rgba(255, 255, 255, 0.8);
        padding: 0.2rem 0.5rem;
        border-radius: 10px;
        font-size: 0.8rem;
        min-width: 20px;
        text-align: center;
    }
    
    /* –ü–æ—Å—Ç—ã */
    .posts-container {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
    }
    
    /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–µ—Ä–µ—Å–ª–∞–Ω–Ω–æ–≥–æ –ø–æ—Å—Ç–∞ */
    .repost-indicator {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem 1rem;
        background: rgba(52, 152, 219, 0.1);
        border-radius: 8px;
        margin-bottom: 1rem;
        font-size: 0.9rem;
        color: rgba(26, 26, 26, 0.8);
    }
    
    .repost-indicator i {
        color: #007AFF;
        font-size: 0.8rem;
    }
    
    .repost-indicator em {
    font-style: italic;
    color: rgba(255, 255, 255, 0.7);
}

.community-indicator {
    background: rgba(0, 122, 255, 0.08);
    border: 1px solid rgba(0, 122, 255, 0.2);
    border-radius: 8px;
    padding: 0.5rem 0.75rem;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.9rem;
    color: rgba(26, 26, 26, 0.85);
}

.community-indicator i {
    color: #007AFF;
    font-size: 0.9rem;
}

.community-indicator em {
    font-style: italic;
    color: rgba(26, 26, 26, 0.7);
}

.community-link {
    color: #007AFF;
    text-decoration: none;
    font-weight: 600;
}

.community-link:hover {
    text-decoration: underline;
}
    
.original-author-link {
    color: #007AFF;
        text-decoration: none;
        font-weight: 500;
        transition: color 0.3s ease;
    }
    
    .original-author-link:hover {
        color: #005FCC;
        text-decoration: underline;
    }
    
    .post-card {
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 8px;
        padding: 2rem;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }
    
    .post-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: #007AFF;
        opacity: 0.9;
    }

    /* –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π */
    .suggestions-card {
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-radius: 8px;
        padding: 1.25rem;
        margin: 1.5rem 0;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
    }
    .suggestions-header h4 { margin: 0 0 1rem 0; color: #1A1A1A; display:flex; align-items:center; gap:0.5rem; }
    .suggestions-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 0.75rem; }
    .suggestion-item { display:grid; grid-template-columns: 1fr auto; align-items:center; column-gap: 0.75rem; padding: 0.6rem 0.75rem; border:1px solid rgba(0,0,0,0.06); border-radius:8px; background:#fff; }
    .suggest-user { display:flex; align-items:center; gap:0.75rem; text-decoration:none; color:#1A1A1A; min-width:0; }
    .suggest-avatar { width:40px; height:40px; border-radius:50%; background:linear-gradient(45deg,#007AFF,#66A3FF); color:#fff; display:flex; align-items:center; justify-content:center; font-weight:700; flex-shrink:0; overflow:hidden; }
    .suggest-avatar img{ width:100%; height:100%; object-fit:cover; border-radius:50%; }
    .suggest-info{ min-width:0; }
    .suggest-name{ font-weight:600; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .suggest-username{ color:rgba(26,26,26,0.6); font-size:0.9rem; }
    .follow-btn{ background:#007AFF; color:#fff!important; border-radius:8px; padding:0.45rem 0.7rem; text-decoration:none; font-weight:600; display:inline-flex; align-items:center; gap:0.4rem; box-shadow:0 2px 8px rgba(0,0,0,0.08); justify-self:end; white-space: nowrap; }
    .follow-btn:hover{ background:#005FCC; }
    
    .post-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 24px rgba(0, 0, 0, 0.08);
        border-color: rgba(0, 0, 0, 0.12);
    }
    
    .post-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 1.5rem;
    }
    
    .post-user-info {
        display: flex;
        align-items: center;
        gap: 1rem;
    }
    
    .post-avatar {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: linear-gradient(45deg, #3498db, #2ecc71);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        color: white;
        font-size: 1.2rem;
        position: relative;
    }
    
    .post-avatar::after {
        content: '';
        position: absolute;
        bottom: 2px;
        right: 2px;
        width: 12px;
        height: 12px;
        background: #2ecc71;
        border: 2px solid #1a1a2e;
        border-radius: 50%;
    }
    
    .user-details {
        display: flex;
        flex-direction: column;
        gap: 0.25rem;
    }
    
    .user-name {
        margin: 0;
        font-size: 1.1rem;
        font-weight: 600;
    }
    
    .user-name a {
        color: #1A1A1A;
        text-decoration: none;
        transition: color 0.3s ease;
    }
    
    .user-name a:hover {
        color: #007AFF;
    }
    
    .post-meta {
        display: flex;
        align-items: center;
        gap: 1rem;
        font-size: 0.9rem;
    }
    
    .username {
        color: #3498db;
        font-weight: 500;
    }
    
    .post-time {
        color: rgba(26, 26, 26, 0.6);
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }
    
    .post-menu {
        position: relative;
    }
    
    .menu-btn {
        background: none;
        border: none;
        color: rgba(26, 26, 26, 0.6);
        padding: 0.5rem;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 1.1rem;
    }
    
    .menu-btn:hover {
        background: rgba(0, 0, 0, 0.05);
        color: #1A1A1A;
    }
    
    .post-content {
        margin-bottom: 1.5rem;
    }
    
    .post-content p {
        color: #1A1A1A;
        font-size: 1.1rem;
        line-height: 1.6;
        margin: 0;
    }
    
    /* –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –ø–æ—Å—Ç–∞—Ö */
    .post-image {
        margin: 1rem 0;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
        border: 1px solid rgba(0, 0, 0, 0.08);
        background: #ffffff;
    }
    
    .post-image-content {
        width: 100%;
        max-height: 600px;
        object-fit: contain;
        display: block;
        cursor: pointer;
        transition: transform 0.3s ease;
    }
    
    .post-image-content:hover {
        transform: scale(1.02);
    }
    
    /* –í–∏–¥–µ–æ –≤ –ø–æ—Å—Ç–∞—Ö */
    .post-video {
        margin: 1rem 0;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
        border: 1px solid rgba(0, 0, 0, 0.08);
        background: #000000;
    }
    
    .post-video video {
        width: 100%;
        max-height: 600px;
        object-fit: contain;
        display: block;
    }
    
    /* –≠–º–æ–¥–∑–∏ –≤ –ø–æ—Å—Ç–∞—Ö */
    .post-emoji {
        margin: 1rem 0;
        text-align: center;
    }
    
    .emoji-display {
        font-size: 3rem;
        display: inline-block;
        animation: emoji-bounce 0.6s ease-in-out;
    }
    
    @keyframes emoji-bounce {
        0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
        40% { transform: translateY(-10px); }
        60% { transform: translateY(-5px); }
    }
    
    /* –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –≤ –ø–æ—Å—Ç–∞—Ö */
    .post-location {
        margin: 1rem 0;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 12px;
        padding: 1rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .location-info {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin-bottom: 1rem;
        color: #e74c3c;
        font-weight: 500;
    }
    
    .location-info i {
        font-size: 1.2rem;
    }
    
    .location-map {
        width: 100%;
        height: 200px;
        border-radius: 8px;
        background: #2c3e50;
        position: relative;
        overflow: hidden;
    }
    
    .location-map::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 20px;
        height: 20px;
        background: #e74c3c;
        border-radius: 50%;
        border: 3px solid white;
        box-shadow: 0 0 10px rgba(231, 76, 60, 0.5);
        z-index: 2;
    }
    
    .location-map::after {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 40px;
        height: 40px;
        background: rgba(231, 76, 60, 0.2);
        border-radius: 50%;
        animation: location-pulse 2s infinite;
    }
    
    @keyframes location-pulse {
        0% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        100% { transform: translate(-50%, -50%) scale(2); opacity: 0; }
    }
    
    .post-stats {
        display: flex;
        gap: 2rem;
        padding: 1rem 0;
        border-top: 1px solid rgba(0, 0, 0, 0.08);
        border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        margin-bottom: 1.5rem;
    }
    
    .stat-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: rgba(26, 26, 26, 0.7);
        font-size: 0.9rem;
    }
    
    .stat-item i {
        color: #007AFF;
    }
    
    .post-actions {
        display: flex;
        gap: 1rem;
        justify-content: space-around;
    }
    
    .action-btn {
        background: rgba(0, 0, 0, 0.04);
        border: 1px solid rgba(0, 0, 0, 0.08);
        color: rgba(26, 26, 26, 0.85);
        padding: 0.75rem 1.5rem;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.95rem;
        font-weight: 500;
        flex: 1;
        justify-content: center;
    }
    
    .action-btn:hover {
        background: rgba(0, 0, 0, 0.06);
        color: #1A1A1A;
        transform: translateY(-2px);
    }
    
    .action-btn.liked {
        color: #e74c3c;
        background: rgba(231, 76, 60, 0.1);
    }
    
    .action-btn.liked:hover {
        background: rgba(231, 76, 60, 0.2);
    }
    
    /* –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ */
    .comments-section {
        margin-top: 1.5rem;
        padding-top: 1.5rem;
        border-top: 1px solid rgba(0, 0, 0, 0.08);
    }
    
    .comments-header h4 {
        color: #1A1A1A;
        margin: 0 0 1rem 0;
        font-size: 1.1rem;
        font-weight: 600;
    }
    
    .comment-form {
        margin-bottom: 1.5rem;
    }
    
    .comment-input-wrapper {
        display: flex;
        gap: 0.75rem;
        align-items: center;
    }
    
    .comment-input {
        flex: 1;
        padding: 0.75rem 1rem;
        border: 1px solid rgba(0, 0, 0, 0.12);
        border-radius: 8px;
        background: #ffffff;
        color: #1A1A1A;
        font-size: 0.95rem;
        transition: all 0.3s ease;
    }
    
    .comment-input:focus {
        outline: none;
        border-color: #007AFF;
        background: #ffffff;
        box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.12);
    }
    
    .comment-submit {
        background: #007AFF;
        border: none;
        color: white;
        padding: 0.75rem;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 1rem;
    }
    
    .comment-submit:hover {
        background: #005FCC;
        transform: translateY(-2px);
    }
    
    .comments-list {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }
    
    .comment-item {
        display: flex;
        gap: 1rem;
        padding: 1rem;
        background: #ffffff;
        border-radius: 8px;
        border: 1px solid rgba(0, 0, 0, 0.08);
        border-left: 3px solid #007AFF;
    }
    
    .comment-avatar {
        width: 35px;
        height: 35px;
        border-radius: 50%;
        background: linear-gradient(45deg, #f39c12, #e67e22);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        color: white;
        font-size: 0.9rem;
        flex-shrink: 0;
    }
    
    .comment-content {
        flex: 1;
    }
    
    .comment-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.5rem;
    }
    
    .comment-author {
        color: #007AFF;
        font-weight: 600;
        font-size: 0.9rem;
    }
    
    .comment-time {
        color: rgba(26, 26, 26, 0.5);
        font-size: 0.8rem;
    }
    
    .comment-text {
        color: rgba(26, 26, 26, 0.9);
        margin: 0 0 0.75rem 0;
        line-height: 1.5;
    }
    
    .comment-actions {
        display: flex;
        gap: 0.5rem;
    }
    
    .comment-action-btn {
        background: none;
        border: none;
        color: #e74c3c;
        padding: 0.25rem 0.5rem;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 0.8rem;
        display: flex;
        align-items: center;
        gap: 0.25rem;
    }
    
    .comment-action-btn:hover {
        background: rgba(231, 76, 60, 0.1);
    }
    
    /* –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ */
    .empty-state {
        text-align: center;
        padding: 4rem 2rem;
        background: #ffffff;
        border-radius: 8px;
        border: 1px solid rgba(0, 0, 0, 0.08);
    }
    
    .empty-icon {
        font-size: 4rem;
        color: rgba(26, 26, 26, 0.25);
        margin-bottom: 1.5rem;
    }
    
    .empty-state h3 {
        color: rgba(26, 26, 26, 0.85);
        margin-bottom: 1rem;
        font-size: 1.8rem;
    }
    
    .empty-state p {
        color: rgba(26, 26, 26, 0.6);
        margin-bottom: 2rem;
        font-size: 1.1rem;
    }
    
    .empty-actions .btn {
        padding: 1rem 2rem;
        border: none;
        border-radius: 12px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.75rem;
    }
    
    .btn-primary {
        background: #007AFF;
        color: white;
    }
    
    .btn-primary:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 25px rgba(52, 152, 219, 0.3);
    }
    
    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
    @media (max-width: 1200px) {
        .feed-layout {
            grid-template-columns: 1fr 280px;
            gap: 1.5rem;
        }
    }
    
    @media (max-width: 900px) {
        .feed-layout {
            grid-template-columns: 1fr;
            gap: 1rem;
        }
        
        .ads-column {
            display: none;
        }
    }
    
    @media (max-width: 768px) {
        .feed-layout {
            padding: 0 0.5rem;
        }
        
        .create-post-card {
            padding: 1.5rem;
        }
        
        .create-post-header {
            flex-direction: column;
            text-align: center;
            gap: 1rem;
        }
        
        .form-actions {
            flex-direction: column;
            gap: 1rem;
        }
        
        .post-options {
            justify-content: center;
        }
        
        .publish-btn {
            width: 100%;
            justify-content: center;
        }
        
        .post-card {
            padding: 1.5rem;
        }
        
        .post-actions {
            flex-direction: column;
        }
        
        .action-btn {
            justify-content: center;
        }
        
        .post-stats {
            flex-direction: column;
            gap: 1rem;
        }
    }
    
    /* Popup —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ—Å—Ç–∞ */
    .post-settings-popup {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 2000;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .popup-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.4);
    }
    
    .popup-content {
        position: relative;
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.12);
        border-radius: 8px;
        padding: 0;
        max-width: 500px;
        width: 90%;
        max-height: 80vh;
        overflow-y: auto;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.16);
        animation: popupSlideIn 0.3s ease-out;
        /* –£–±–∏—Ä–∞–µ–º transform –¥–ª—è –ª—É—á—à–µ–≥–æ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è */
        margin: auto;
    }
    
    @keyframes popupSlideIn {
        from {
            opacity: 0;
            transform: scale(0.9);
        }
        to {
            opacity: 1;
            transform: scale(1);
        }
    }
    
    .popup-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1.25rem 1.5rem 1rem 1.5rem;
        border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        background: #ffffff;
        border-radius: 8px 8px 0 0;
    }
    
    .popup-header h3 {
        color: #1A1A1A;
        margin: 0;
        font-size: 1.4rem;
        font-weight: 600;
    }
    
    .close-popup-btn {
        background: #ffffff;
        border: 1px solid rgba(0, 0, 0, 0.12);
        color: #1A1A1A;
        padding: 0.75rem;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.1rem;
    }
    
    .close-popup-btn:hover {
        background: rgba(0, 0, 0, 0.04);
        color: #1A1A1A;
        transform: scale(1.05);
    }
    
    .popup-body {
        padding: 1.5rem;
    }
    
    .popup-body .setting-group {
        margin-bottom: 2rem;
    }
    
    .popup-body .setting-group:last-child {
        margin-bottom: 0;
    }
    
    .popup-body .setting-group label {
        display: block;
        color: #1A1A1A;
        font-size: 1rem;
        margin-bottom: 0.75rem;
        font-weight: 600;
    }
    
    .popup-body .post-select,
    .popup-body .post-input {
        width: 100%;
        padding: 0.9rem 1rem;
        border: 1px solid rgba(0, 0, 0, 0.12);
        border-radius: 8px;
        background: #ffffff;
        color: #1A1A1A;
        font-size: 1rem;
        transition: all 0.2s ease;
    }
    
    .popup-body .post-select:focus,
    .popup-body .post-input:focus {
        outline: none;
        border-color: #007AFF;
        background: #ffffff;
        box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.12);
    }
    
    .popup-body .post-select option {
        background: #ffffff;
        color: #1A1A1A;
        padding: 0.5rem;
    }
    
    .setting-hint {
        display: block;
        color: rgba(26, 26, 26, 0.6);
        font-size: 0.85rem;
        margin-top: 0.5rem;
        font-style: italic;
    }
    
    .popup-footer {
        display: flex;
        gap: 1rem;
        padding: 1rem 1.5rem 1.5rem 1.5rem;
        border-top: 1px solid rgba(0, 0, 0, 0.08);
        background: #ffffff;
        border-radius: 0 0 8px 8px;
    }
    
    .popup-footer .btn {
        flex: 1;
        padding: 0.9rem 1.2rem;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.75rem;
        text-decoration: none;
    }
    
    .btn-secondary {
        background: #ffffff;
        color: #1A1A1A;
        border: 1px solid rgba(0, 0, 0, 0.12);
    }
    
    .btn-secondary:hover {
        background: rgba(0, 0, 0, 0.04);
        color: #1A1A1A;
        transform: translateY(-2px);
    }
    
    .btn-primary {
        background: #007AFF;
        color: white;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }
    
    .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        background: #005FCC;
    }
    
    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è popup */
    @media (max-width: 600px) {
        .popup-content {
            width: 95%;
            margin: 1rem;
        }
        
        .popup-header,
        .popup-body,
        .popup-footer {
            padding: 1rem 1.5rem;
        }
        
        .popup-footer {
            flex-direction: column;
        }
        
        .popup-footer .btn {
            width: 100%;
        }
    }
    


    

</style>

        <!-- Popup —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ—Å—Ç–∞ -->
        <div id="post-settings-popup" class="post-settings-popup" style="display: none;">
            <div class="popup-overlay" onclick="closePostSettings()"></div>
            <div class="popup-content">
                <div class="popup-header">
                    <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Å—Ç–∞</h3>
                    <button type="button" class="close-popup-btn" onclick="closePostSettings()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="popup-body">
                    <div class="setting-group">
                        <label for="popup-visibility">–í–∏–¥–∏–º–æ—Å—Ç—å:</label>
                        <select name="popup-visibility" id="popup-visibility" class="post-select">
                            <option value="public">üåç –ü—É–±–ª–∏—á–Ω—ã–π - –≤–∏–¥—è—Ç –≤—Å–µ</option>
                            <option value="friends">üë• –¢–æ–ª—å–∫–æ –¥—Ä—É–∑—å—è - –≤–∏–¥—è—Ç –ø–æ–¥–ø–∏—Å—á–∏–∫–∏</option>
                            <option value="private">üîí –ü—Ä–∏–≤–∞—Ç–Ω—ã–π - –≤–∏–¥–∏—Ç–µ —Ç–æ–ª—å–∫–æ –≤—ã</option>
                        </select>
                    </div>
                    
                    <div class="setting-group">
                        <label for="popup-category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
                        <select name="popup-category" id="popup-category" class="post-select">
                            <option value="">üìÇ –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                            <option value="–û–±—â–µ–µ">üåê –û–±—â–µ–µ</option>
                            <option value="–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏">üíª –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</option>
                            <option value="–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è">üéÆ –†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</option>
                            <option value="–°–ø–æ—Ä—Ç">‚öΩ –°–ø–æ—Ä—Ç</option>
                            <option value="–ú—É–∑—ã–∫–∞">üéµ –ú—É–∑—ã–∫–∞</option>
                            <option value="–ö–∏–Ω–æ">üé¨ –ö–∏–Ω–æ</option>
                            <option value="–ö—É–ª–∏–Ω–∞—Ä–∏—è">üç≥ –ö—É–ª–∏–Ω–∞—Ä–∏—è</option>
                            <option value="–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è">‚úàÔ∏è –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è</option>
                            <option value="–ú–æ–¥–∞">üëó –ú–æ–¥–∞</option>
                            <option value="–ê–≤—Ç–æ">üöó –ê–≤—Ç–æ</option>
                        </select>
                    </div>
                    
                    <div class="setting-group">
                        <label for="popup-tags">–¢–µ–≥–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):</label>
                        <input type="text" name="popup-tags" id="popup-tags" class="post-input" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏, –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ, python">
                        <small class="setting-hint">–¢–µ–≥–∏ –ø–æ–º–æ–≥—É—Ç –¥—Ä—É–≥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –Ω–∞–π—Ç–∏ –≤–∞—à –ø–æ—Å—Ç</small>
                    </div>
                </div>
                
                <div class="popup-footer">
                    <button type="button" class="btn btn-secondary" onclick="closePostSettings()">
                        <i class="fas fa-times"></i> –û—Ç–º–µ–Ω–∞
                    </button>
                    <button type="button" class="btn btn-primary" onclick="publishPost()">
                        <i class="fas fa-paper-plane"></i> –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å
                    </button>
                </div>
            </div>
        </div>


{% endblock %}
